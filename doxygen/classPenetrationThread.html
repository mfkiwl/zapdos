<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zapdos: PenetrationThread Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
    <a href="https://shannon-lab.github.io/zapdos" style="text-decoration:none"><div id="projectname">Zapdos</div></a><div id="projectname">
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classPenetrationThread-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PenetrationThread Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPenetrationThread_1_1RidgeData.html">RidgeData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPenetrationThread_1_1RidgeSetData.html">RidgeSetData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4563b29500d3accd58944f88b090d562"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a4563b29500d3accd58944f88b090d562">PenetrationThread</a> (<a class="el" href="classSubProblem.html">SubProblem</a> &amp;subproblem, const <a class="el" href="classMooseMesh.html">MooseMesh</a> &amp;mesh, <a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a> primary_boundary, <a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a> secondary_boundary, std::map&lt; dof_id_type, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;penetration_info, bool check_whether_reasonable, bool update_location, Real tangential_tolerance, bool do_normal_smoothing, Real normal_smoothing_distance, <a class="el" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418">PenetrationLocator::NORMAL_SMOOTHING_METHOD</a> normal_smoothing_method, std::vector&lt; std::vector&lt; FEBase * &gt; &gt; &amp;fes, FEType &amp;fe_type, <a class="el" href="classNearestNodeLocator.html">NearestNodeLocator</a> &amp;nearest_node, const std::map&lt; dof_id_type, std::vector&lt; dof_id_type &gt; &gt; &amp;node_to_elem_map, const std::vector&lt; std::tuple&lt; dof_id_type, unsigned short int, boundary_id_type &gt; &gt; &amp;bc_tuples)</td></tr>
<tr class="separator:a4563b29500d3accd58944f88b090d562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f4f9ffd19c88b504d2bc23a31814d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a72f4f9ffd19c88b504d2bc23a31814d2">PenetrationThread</a> (<a class="el" href="classPenetrationThread.html">PenetrationThread</a> &amp;x, Threads::split split)</td></tr>
<tr class="separator:a72f4f9ffd19c88b504d2bc23a31814d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f25d7fe5c110cac3eb45a87e9a4c76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a44f25d7fe5c110cac3eb45a87e9a4c76">operator()</a> (const <a class="el" href="MooseTypes_8h.html#ac1e1763891f78be5c11fde4d9c03effd">NodeIdRange</a> &amp;range)</td></tr>
<tr class="separator:a44f25d7fe5c110cac3eb45a87e9a4c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace197eadb3ba19016cca2c32cac6281a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ace197eadb3ba19016cca2c32cac6281a">join</a> (const <a class="el" href="classPenetrationThread.html">PenetrationThread</a> &amp;other)</td></tr>
<tr class="separator:ace197eadb3ba19016cca2c32cac6281a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a5e6f815a9ef19c2835a0d017ba8201b5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; dof_id_type &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a></td></tr>
<tr class="memdesc:a5e6f815a9ef19c2835a0d017ba8201b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of secondary nodes for which penetration was not detected in the current patch and for which patch has to be updated.  <a href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">More...</a><br /></td></tr>
<tr class="separator:a5e6f815a9ef19c2835a0d017ba8201b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-types" name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:ac798f14b005d69d51f3075930607d206"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a> { <a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>
, <a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>
, <a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>
 }</td></tr>
<tr class="separator:ac798f14b005d69d51f3075930607d206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbdfcaf4eef16f85971bf60a7819064f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">CommonEdgeResult</a> { <a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29">NO_COMMON</a>
, <a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">COMMON_EDGE</a>
, <a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a">COMMON_NODE</a>
, <a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">EDGE_AND_COMMON_NODE</a>
 }</td></tr>
<tr class="separator:abbdfcaf4eef16f85971bf60a7819064f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afce58305a7fce32380a8d3061ca114a3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#afce58305a7fce32380a8d3061ca114a3">competeInteractions</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi1, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi2)</td></tr>
<tr class="memdesc:afce58305a7fce32380a8d3061ca114a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">When interactions are identified between a node and two faces, compete between the faces to determine whether first (pi1) or second (pi2) interaction is stronger.  <a href="classPenetrationThread.html#afce58305a7fce32380a8d3061ca114a3">More...</a><br /></td></tr>
<tr class="separator:afce58305a7fce32380a8d3061ca114a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc662dabb507ed7cdbd573eb7c27c13c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#afc662dabb507ed7cdbd573eb7c27c13c">competeInteractionsBothOnFace</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi1, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi2)</td></tr>
<tr class="memdesc:afc662dabb507ed7cdbd573eb7c27c13c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine whether first (pi1) or second (pi2) interaction is stronger when it is known that the node projects to both of the two competing faces.  <a href="classPenetrationThread.html#afc662dabb507ed7cdbd573eb7c27c13c">More...</a><br /></td></tr>
<tr class="separator:afc662dabb507ed7cdbd573eb7c27c13c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9701265e89432ca9f5692952af8b068a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">CommonEdgeResult</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a9701265e89432ca9f5692952af8b068a">interactionsOffCommonEdge</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi1, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *pi2)</td></tr>
<tr class="separator:a9701265e89432ca9f5692952af8b068a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed2aedb63399dd31f62684d459c6494"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#afed2aedb63399dd31f62684d459c6494">findRidgeContactPoint</a> (Point &amp;contact_point, Real &amp;tangential_distance, const Node *&amp;closest_node, unsigned int &amp;index, Point &amp;contact_point_ref, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info, const unsigned int index1, const unsigned int index2)</td></tr>
<tr class="separator:afed2aedb63399dd31f62684d459c6494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a613ea76c025bb0e6b137795dc77a3561"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a613ea76c025bb0e6b137795dc77a3561">getSideCornerNodes</a> (const Elem *side, std::vector&lt; const Node * &gt; &amp;corner_nodes)</td></tr>
<tr class="separator:a613ea76c025bb0e6b137795dc77a3561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa865ac60b45804ace8ddefe9333c0c7b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#aa865ac60b45804ace8ddefe9333c0c7b">restrictPointToSpecifiedEdgeOfFace</a> (Point &amp;p, const Node *&amp;closest_node, const Elem *side, const std::vector&lt; const Node * &gt; &amp;edge_nodes)</td></tr>
<tr class="separator:aa865ac60b45804ace8ddefe9333c0c7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd8671738159f333a5f235a17ca15bd6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#acd8671738159f333a5f235a17ca15bd6">restrictPointToFace</a> (Point &amp;p, const Node *&amp;closest_node, const Elem *side)</td></tr>
<tr class="separator:acd8671738159f333a5f235a17ca15bd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adee847f1d95b90693e8ce87e62aaba69"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#adee847f1d95b90693e8ce87e62aaba69">isFaceReasonableCandidate</a> (const Elem *primary_elem, const Elem *side, FEBase *fe, const Point *secondary_point, const Real tangential_tolerance)</td></tr>
<tr class="separator:adee847f1d95b90693e8ce87e62aaba69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8cbc491aace5690cfb51cceb97a9351"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ae8cbc491aace5690cfb51cceb97a9351">smoothNormal</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *info, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info, const Node &amp;node)</td></tr>
<tr class="separator:ae8cbc491aace5690cfb51cceb97a9351"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec2a4106b14e45786a65d2ce6b5fae96"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#aec2a4106b14e45786a65d2ce6b5fae96">getSmoothingFacesAndWeights</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *info, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;edge_face_info, std::vector&lt; Real &gt; &amp;edge_face_weights, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info, const Node &amp;secondary_node)</td></tr>
<tr class="separator:aec2a4106b14e45786a65d2ce6b5fae96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95093c8e61d812efc78503a056115fe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a95093c8e61d812efc78503a056115fe9">getSmoothingEdgeNodesAndWeights</a> (const Point &amp;p, const Elem *side, std::vector&lt; std::vector&lt; const Node * &gt; &gt; &amp;edge_nodes, std::vector&lt; Real &gt; &amp;edge_face_weights)</td></tr>
<tr class="separator:a95093c8e61d812efc78503a056115fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3bc5ded9e8d66365af79bea2399617"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#aca3bc5ded9e8d66365af79bea2399617">getInfoForFacesWithCommonNodes</a> (const Node *secondary_node, const std::set&lt; dof_id_type &gt; &amp;elems_to_exclude, const std::vector&lt; const Node * &gt; edge_nodes, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;face_info_comm_edge, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info)</td></tr>
<tr class="separator:aca3bc5ded9e8d66365af79bea2399617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a518757e67583ef5811d889beb5ce1617"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a518757e67583ef5811d889beb5ce1617">getInfoForElem</a> (std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;thisElemInfo, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info, const Elem *elem)</td></tr>
<tr class="separator:a518757e67583ef5811d889beb5ce1617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a5e021c838e9000723e640ebfb98b20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a0a5e021c838e9000723e640ebfb98b20">createInfoForElem</a> (std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;thisElemInfo, std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;p_info, const Node *secondary_node, const Elem *elem, const std::vector&lt; const Node * &gt; &amp;nodes_that_must_be_on_side, const bool check_whether_reasonable=false)</td></tr>
<tr class="separator:a0a5e021c838e9000723e640ebfb98b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3556d66260ef56dcf6cac6219de7cb7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ab3556d66260ef56dcf6cac6219de7cb7">getSidesOnPrimaryBoundary</a> (std::vector&lt; unsigned int &gt; &amp;sides, const Elem *const elem)</td></tr>
<tr class="separator:ab3556d66260ef56dcf6cac6219de7cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa200ad4fed9a188c3e5a7287881ed673"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#aa200ad4fed9a188c3e5a7287881ed673">computeSlip</a> (FEBase &amp;fe, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> &amp;info)</td></tr>
<tr class="separator:aa200ad4fed9a188c3e5a7287881ed673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f761e759cbcdd607aa3bfe0cce57a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a89f761e759cbcdd607aa3bfe0cce57a9">switchInfo</a> (<a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&amp;info, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&amp;infoNew)</td></tr>
<tr class="separator:a89f761e759cbcdd607aa3bfe0cce57a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:af12aa39941322927db05b53db5015973"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSubProblem.html">SubProblem</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a></td></tr>
<tr class="separator:af12aa39941322927db05b53db5015973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54eff71efe30dbc6a66c0a4f265fbde"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMooseMesh.html">MooseMesh</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a></td></tr>
<tr class="separator:aa54eff71efe30dbc6a66c0a4f265fbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5fba35e105afe524a8d54249d3afe8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">_primary_boundary</a></td></tr>
<tr class="separator:afa5fba35e105afe524a8d54249d3afe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8714749cf9b5fe2483b844342daab7ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a8714749cf9b5fe2483b844342daab7ad">_secondary_boundary</a></td></tr>
<tr class="separator:a8714749cf9b5fe2483b844342daab7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13db996555fd7db080562a79a5ecac48"><td class="memItemLeft" align="right" valign="top">std::map&lt; dof_id_type, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">_penetration_info</a></td></tr>
<tr class="separator:a13db996555fd7db080562a79a5ecac48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288d215a74b64a28d24b1d140cd250ae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">_check_whether_reasonable</a></td></tr>
<tr class="separator:a288d215a74b64a28d24b1d140cd250ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ae4101cc5ecf1533d16822c24ef746"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">_update_location</a></td></tr>
<tr class="separator:a82ae4101cc5ecf1533d16822c24ef746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7175fbcdc90c32d942dad42ad93d5474"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a></td></tr>
<tr class="separator:a7175fbcdc90c32d942dad42ad93d5474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c899c195c1329bff00d82b4601faa75"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a></td></tr>
<tr class="separator:a8c899c195c1329bff00d82b4601faa75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9bd6652bbfa243effaa2c88f21c9582"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a></td></tr>
<tr class="separator:ac9bd6652bbfa243effaa2c88f21c9582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6786cad0beae15e7ff3b5a8ebe7a8e3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418">PenetrationLocator::NORMAL_SMOOTHING_METHOD</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a></td></tr>
<tr class="separator:ad6786cad0beae15e7ff3b5a8ebe7a8e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155ca06846b2d2adf31c6a0d0f854ee5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a155ca06846b2d2adf31c6a0d0f854ee5">_nodal_normal_x</a></td></tr>
<tr class="separator:a155ca06846b2d2adf31c6a0d0f854ee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f6b5d6b51acb18db71e2d97bc03f6b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a5f6b5d6b51acb18db71e2d97bc03f6b3">_nodal_normal_y</a></td></tr>
<tr class="separator:a5f6b5d6b51acb18db71e2d97bc03f6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b725e379e763363279e9526132b196"><td class="memItemLeft" align="right" valign="top"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a59b725e379e763363279e9526132b196">_nodal_normal_z</a></td></tr>
<tr class="separator:a59b725e379e763363279e9526132b196"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6706d9502ecbf54b0651cc2f0a7699b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; FEBase * &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a></td></tr>
<tr class="separator:ae6706d9502ecbf54b0651cc2f0a7699b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1f236c5648c31a2f14b8c8e00cf4f9a"><td class="memItemLeft" align="right" valign="top">FEType &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a></td></tr>
<tr class="separator:af1f236c5648c31a2f14b8c8e00cf4f9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad35dd91b4b0d3d7da352448f2db98261"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNearestNodeLocator.html">NearestNodeLocator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">_nearest_node</a></td></tr>
<tr class="separator:ad35dd91b4b0d3d7da352448f2db98261"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5e53096048ca50930377df4b1d37354"><td class="memItemLeft" align="right" valign="top">const std::map&lt; dof_id_type, std::vector&lt; dof_id_type &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a></td></tr>
<tr class="separator:ab5e53096048ca50930377df4b1d37354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a636421718b7ba96962c4e9d9347476ef"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::tuple&lt; dof_id_type, unsigned short int, boundary_id_type &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a></td></tr>
<tr class="separator:a636421718b7ba96962c4e9d9347476ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c19836ab3ed65b2aa57ce8e022bcf98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="MooseTypes_8h.html#ad3086fc227668c55ccebaeb1c676fc3a">THREAD_ID</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a></td></tr>
<tr class="separator:a1c19836ab3ed65b2aa57ce8e022bcf98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed2112a71c151ab10f9e2ece58ed1d5"><td class="memItemLeft" align="right" valign="top">ElemSideBuilder&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPenetrationThread.html#afed2112a71c151ab10f9e2ece58ed1d5">_elem_side_builder</a></td></tr>
<tr class="memdesc:afed2112a71c151ab10f9e2ece58ed1d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper for building element sides without extraneous allocation.  <a href="classPenetrationThread.html#afed2112a71c151ab10f9e2ece58ed1d5">More...</a><br /></td></tr>
<tr class="separator:afed2112a71c151ab10f9e2ece58ed1d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00024">24</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a id="abbdfcaf4eef16f85971bf60a7819064f" name="abbdfcaf4eef16f85971bf60a7819064f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbdfcaf4eef16f85971bf60a7819064f">&#9670;&#160;</a></span>CommonEdgeResult</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">PenetrationThread::CommonEdgeResult</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29" name="abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29"></a>NO_COMMON&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0" name="abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0"></a>COMMON_EDGE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a" name="abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a"></a>COMMON_NODE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658" name="abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658"></a>EDGE_AND_COMMON_NODE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00098">98</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>  {</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29">NO_COMMON</a>,</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">COMMON_EDGE</a>,</div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a">COMMON_NODE</a>,</div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">EDGE_AND_COMMON_NODE</a></div>
<div class="line"><span class="lineno">  104</span>  };</div>
<div class="ttc" id="aclassPenetrationThread_html_abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a"><div class="ttname"><a href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a">PenetrationThread::COMMON_NODE</a></div><div class="ttdeci">@ COMMON_NODE</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00102">PenetrationThread.h:102</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0"><div class="ttname"><a href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">PenetrationThread::COMMON_EDGE</a></div><div class="ttdeci">@ COMMON_EDGE</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00101">PenetrationThread.h:101</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29"><div class="ttname"><a href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29">PenetrationThread::NO_COMMON</a></div><div class="ttdeci">@ NO_COMMON</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00100">PenetrationThread.h:100</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658"><div class="ttname"><a href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">PenetrationThread::EDGE_AND_COMMON_NODE</a></div><div class="ttdeci">@ EDGE_AND_COMMON_NODE</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00104">PenetrationThread.h:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac798f14b005d69d51f3075930607d206" name="ac798f14b005d69d51f3075930607d206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac798f14b005d69d51f3075930607d206">&#9670;&#160;</a></span>CompeteInteractionResult</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">PenetrationThread::CompeteInteractionResult</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1" name="ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1"></a>FIRST_WINS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca" name="ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca"></a>SECOND_WINS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6" name="ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6"></a>NEITHER_WINS&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00091">91</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>  {</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>,</div>
<div class="line"><span class="lineno">   94</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>,</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a></div>
<div class="line"><span class="lineno">   96</span>  };</div>
<div class="ttc" id="aclassPenetrationThread_html_ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6"><div class="ttname"><a href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">PenetrationThread::NEITHER_WINS</a></div><div class="ttdeci">@ NEITHER_WINS</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00096">PenetrationThread.h:95</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1"><div class="ttname"><a href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">PenetrationThread::FIRST_WINS</a></div><div class="ttdeci">@ FIRST_WINS</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00093">PenetrationThread.h:93</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca"><div class="ttname"><a href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">PenetrationThread::SECOND_WINS</a></div><div class="ttdeci">@ SECOND_WINS</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00094">PenetrationThread.h:94</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4563b29500d3accd58944f88b090d562" name="a4563b29500d3accd58944f88b090d562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4563b29500d3accd58944f88b090d562">&#9670;&#160;</a></span>PenetrationThread() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PenetrationThread::PenetrationThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSubProblem.html">SubProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>subproblem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classMooseMesh.html">MooseMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a>&#160;</td>
          <td class="paramname"><em>primary_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a>&#160;</td>
          <td class="paramname"><em>secondary_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; dof_id_type, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>penetration_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>check_whether_reasonable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>update_location</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>tangential_tolerance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>do_normal_smoothing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>normal_smoothing_distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418">PenetrationLocator::NORMAL_SMOOTHING_METHOD</a>&#160;</td>
          <td class="paramname"><em>normal_smoothing_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; FEBase * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>fes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FEType &amp;&#160;</td>
          <td class="paramname"><em>fe_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNearestNodeLocator.html">NearestNodeLocator</a> &amp;&#160;</td>
          <td class="paramname"><em>nearest_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; dof_id_type, std::vector&lt; dof_id_type &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_to_elem_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::tuple&lt; dof_id_type, unsigned short int, boundary_id_type &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>bc_tuples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00027">27</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   44</span>  : <a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>(subproblem),</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>(mesh),</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_variable" href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">_primary_boundary</a>(primary_boundary),</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_variable" href="classPenetrationThread.html#a8714749cf9b5fe2483b844342daab7ad">_secondary_boundary</a>(secondary_boundary),</div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">_penetration_info</a>(penetration_info),</div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">_check_whether_reasonable</a>(check_whether_reasonable),</div>
<div class="line"><span class="lineno">   50</span>    <a class="code hl_variable" href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">_update_location</a>(update_location),</div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>(tangential_tolerance),</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a>(do_normal_smoothing),</div>
<div class="line"><span class="lineno">   53</span>    <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>(normal_smoothing_distance),</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a>(normal_smoothing_method),</div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="classPenetrationThread.html#a155ca06846b2d2adf31c6a0d0f854ee5">_nodal_normal_x</a>(NULL),</div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_variable" href="classPenetrationThread.html#a5f6b5d6b51acb18db71e2d97bc03f6b3">_nodal_normal_y</a>(NULL),</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_variable" href="classPenetrationThread.html#a59b725e379e763363279e9526132b196">_nodal_normal_z</a>(NULL),</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>(fes),</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>(fe_type),</div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_variable" href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">_nearest_node</a>(nearest_node),</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>(node_to_elem_map),</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_variable" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a>(bc_tuples)</div>
<div class="line"><span class="lineno">   63</span>{</div>
<div class="line"><span class="lineno">   64</span>}</div>
<div class="ttc" id="aclassPenetrationThread_html_a13db996555fd7db080562a79a5ecac48"><div class="ttname"><a href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">PenetrationThread::_penetration_info</a></div><div class="ttdeci">std::map&lt; dof_id_type, PenetrationInfo * &gt; &amp; _penetration_info</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00063">PenetrationThread.h:63</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a155ca06846b2d2adf31c6a0d0f854ee5"><div class="ttname"><a href="classPenetrationThread.html#a155ca06846b2d2adf31c6a0d0f854ee5">PenetrationThread::_nodal_normal_x</a></div><div class="ttdeci">MooseVariable * _nodal_normal_x</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00071">PenetrationThread.h:71</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a288d215a74b64a28d24b1d140cd250ae"><div class="ttname"><a href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">PenetrationThread::_check_whether_reasonable</a></div><div class="ttdeci">bool _check_whether_reasonable</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00065">PenetrationThread.h:65</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a59b725e379e763363279e9526132b196"><div class="ttname"><a href="classPenetrationThread.html#a59b725e379e763363279e9526132b196">PenetrationThread::_nodal_normal_z</a></div><div class="ttdeci">MooseVariable * _nodal_normal_z</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00073">PenetrationThread.h:73</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a5f6b5d6b51acb18db71e2d97bc03f6b3"><div class="ttname"><a href="classPenetrationThread.html#a5f6b5d6b51acb18db71e2d97bc03f6b3">PenetrationThread::_nodal_normal_y</a></div><div class="ttdeci">MooseVariable * _nodal_normal_y</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00072">PenetrationThread.h:72</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a636421718b7ba96962c4e9d9347476ef"><div class="ttname"><a href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">PenetrationThread::_bc_tuples</a></div><div class="ttdeci">const std::vector&lt; std::tuple&lt; dof_id_type, unsigned short int, boundary_id_type &gt; &gt; &amp; _bc_tuples</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00084">PenetrationThread.h:84</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a7175fbcdc90c32d942dad42ad93d5474"><div class="ttname"><a href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">PenetrationThread::_tangential_tolerance</a></div><div class="ttdeci">Real _tangential_tolerance</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00067">PenetrationThread.h:67</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a82ae4101cc5ecf1533d16822c24ef746"><div class="ttname"><a href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">PenetrationThread::_update_location</a></div><div class="ttdeci">bool _update_location</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00066">PenetrationThread.h:66</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a8714749cf9b5fe2483b844342daab7ad"><div class="ttname"><a href="classPenetrationThread.html#a8714749cf9b5fe2483b844342daab7ad">PenetrationThread::_secondary_boundary</a></div><div class="ttdeci">BoundaryID _secondary_boundary</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00060">PenetrationThread.h:60</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a8c899c195c1329bff00d82b4601faa75"><div class="ttname"><a href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">PenetrationThread::_do_normal_smoothing</a></div><div class="ttdeci">bool _do_normal_smoothing</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00068">PenetrationThread.h:68</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_aa54eff71efe30dbc6a66c0a4f265fbde"><div class="ttname"><a href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">PenetrationThread::_mesh</a></div><div class="ttdeci">const MooseMesh &amp; _mesh</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00058">PenetrationThread.h:58</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ab5e53096048ca50930377df4b1d37354"><div class="ttname"><a href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">PenetrationThread::_node_to_elem_map</a></div><div class="ttdeci">const std::map&lt; dof_id_type, std::vector&lt; dof_id_type &gt; &gt; &amp; _node_to_elem_map</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00081">PenetrationThread.h:81</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ac9bd6652bbfa243effaa2c88f21c9582"><div class="ttname"><a href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">PenetrationThread::_normal_smoothing_distance</a></div><div class="ttdeci">Real _normal_smoothing_distance</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00069">PenetrationThread.h:69</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ad35dd91b4b0d3d7da352448f2db98261"><div class="ttname"><a href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">PenetrationThread::_nearest_node</a></div><div class="ttdeci">NearestNodeLocator &amp; _nearest_node</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00079">PenetrationThread.h:79</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ad6786cad0beae15e7ff3b5a8ebe7a8e3"><div class="ttname"><a href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">PenetrationThread::_normal_smoothing_method</a></div><div class="ttdeci">PenetrationLocator::NORMAL_SMOOTHING_METHOD _normal_smoothing_method</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00070">PenetrationThread.h:70</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ae6706d9502ecbf54b0651cc2f0a7699b"><div class="ttname"><a href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">PenetrationThread::_fes</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; FEBase * &gt; &gt; &amp; _fes</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00075">PenetrationThread.h:75</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_af12aa39941322927db05b53db5015973"><div class="ttname"><a href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">PenetrationThread::_subproblem</a></div><div class="ttdeci">SubProblem &amp; _subproblem</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00056">PenetrationThread.h:56</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_af1f236c5648c31a2f14b8c8e00cf4f9a"><div class="ttname"><a href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">PenetrationThread::_fe_type</a></div><div class="ttdeci">FEType &amp; _fe_type</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00077">PenetrationThread.h:77</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_afa5fba35e105afe524a8d54249d3afe8"><div class="ttname"><a href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">PenetrationThread::_primary_boundary</a></div><div class="ttdeci">BoundaryID _primary_boundary</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00059">PenetrationThread.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72f4f9ffd19c88b504d2bc23a31814d2" name="a72f4f9ffd19c88b504d2bc23a31814d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72f4f9ffd19c88b504d2bc23a31814d2">&#9670;&#160;</a></span>PenetrationThread() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PenetrationThread::PenetrationThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationThread.html">PenetrationThread</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Threads::split&#160;</td>
          <td class="paramname"><em>split</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00067">67</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   68</span>  : <a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>),</div>
<div class="line"><span class="lineno">   69</span>    <a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>),</div>
<div class="line"><span class="lineno">   70</span>    <a class="code hl_variable" href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">_primary_boundary</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">_primary_boundary</a>),</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_variable" href="classPenetrationThread.html#a8714749cf9b5fe2483b844342daab7ad">_secondary_boundary</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a8714749cf9b5fe2483b844342daab7ad">_secondary_boundary</a>),</div>
<div class="line"><span class="lineno">   72</span>    <a class="code hl_variable" href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">_penetration_info</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">_penetration_info</a>),</div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_variable" href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">_check_whether_reasonable</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">_check_whether_reasonable</a>),</div>
<div class="line"><span class="lineno">   74</span>    <a class="code hl_variable" href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">_update_location</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">_update_location</a>),</div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>),</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a>),</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>),</div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a>),</div>
<div class="line"><span class="lineno">   79</span>    <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>),</div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>),</div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_variable" href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">_nearest_node</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">_nearest_node</a>),</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>),</div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_variable" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a>(x.<a class="code hl_variable" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a>)</div>
<div class="line"><span class="lineno">   84</span>{</div>
<div class="line"><span class="lineno">   85</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afce58305a7fce32380a8d3061ca114a3" name="afce58305a7fce32380a8d3061ca114a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afce58305a7fce32380a8d3061ca114a3">&#9670;&#160;</a></span>competeInteractions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">PenetrationThread::CompeteInteractionResult</a> PenetrationThread::competeInteractions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When interactions are identified between a node and two faces, compete between the faces to determine whether first (pi1) or second (pi2) interaction is stronger. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pi1</td><td>Pointer to the <a class="el" href="classPenetrationInfo.html" title="Data structure used to hold penetration information.">PenetrationInfo</a> object for the first face </td></tr>
    <tr><td class="paramname">pi2</td><td>Pointer to the <a class="el" href="classPenetrationInfo.html" title="Data structure used to hold penetration information.">PenetrationInfo</a> object for the second face </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Appropriate ComputeInterationResult enum entry identifying which face is a better match </dd></dl>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00505">505</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  506</span>{</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>  <a class="code hl_enumeration" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a> result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>;</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>  <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  511</span>      pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>) <span class="comment">// out of tol on both faces</span></div>
<div class="line"><span class="lineno">  512</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>;</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> == 0.0 &amp;&amp;</div>
<div class="line"><span class="lineno">  515</span>           pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; 0.0) <span class="comment">// on face 1, off face 2</span></div>
<div class="line"><span class="lineno">  516</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> == 0.0 &amp;&amp;</div>
<div class="line"><span class="lineno">  519</span>           pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; 0.0) <span class="comment">// on face 2, off face 1</span></div>
<div class="line"><span class="lineno">  520</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>;</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &lt;= <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  523</span>           pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>) <span class="comment">// in face 1 tol, out of face 2 tol</span></div>
<div class="line"><span class="lineno">  524</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &lt;= <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  527</span>           pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>) <span class="comment">// in face 2 tol, out of face 1 tol</span></div>
<div class="line"><span class="lineno">  528</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>;</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> == 0.0 &amp;&amp; pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> == 0.0) <span class="comment">// on both faces</span></div>
<div class="line"><span class="lineno">  531</span>    result = <a class="code hl_function" href="classPenetrationThread.html#afc662dabb507ed7cdbd573eb7c27c13c">competeInteractionsBothOnFace</a>(pi1, pi2);</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &lt;= <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  534</span>           pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &lt;= <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>) <span class="comment">// off but within tol of both faces</span></div>
<div class="line"><span class="lineno">  535</span>  {</div>
<div class="line"><span class="lineno">  536</span>    <a class="code hl_enumeration" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">CommonEdgeResult</a> cer = <a class="code hl_function" href="classPenetrationThread.html#a9701265e89432ca9f5692952af8b068a">interactionsOffCommonEdge</a>(pi1, pi2);</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">if</span> (cer == <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">COMMON_EDGE</a> || cer == <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a">COMMON_NODE</a>) <span class="comment">// ridge case.</span></div>
<div class="line"><span class="lineno">  538</span>    {</div>
<div class="line"><span class="lineno">  539</span>      <span class="comment">// We already checked for ridges, and it got rejected, so neither face must be valid</span></div>
<div class="line"><span class="lineno">  540</span>      result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>;</div>
<div class="line"><span class="lineno">  541</span>      <span class="comment">//      mooseError(&quot;Erroneously encountered ridge case&quot;);</span></div>
<div class="line"><span class="lineno">  542</span>    }</div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cer == <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">EDGE_AND_COMMON_NODE</a>) <span class="comment">// off side of face, off corner of another face.  Favor</span></div>
<div class="line"><span class="lineno">  544</span>                                          <span class="comment">// the off-side face</span></div>
<div class="line"><span class="lineno">  545</span>    {</div>
<div class="line"><span class="lineno">  546</span>      <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>.size() == pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>.size())</div>
<div class="line"><span class="lineno">  547</span>        <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid off_edge_nodes counts&quot;</span>);</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>.size() == 2)</div>
<div class="line"><span class="lineno">  550</span>        result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>;</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>.size() == 2)</div>
<div class="line"><span class="lineno">  553</span>        result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>;</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  556</span>        <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid off_edge_nodes counts&quot;</span>);</div>
<div class="line"><span class="lineno">  557</span>    }</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">else</span> <span class="comment">// The node projects to both faces within tangential tolerance.</span></div>
<div class="line"><span class="lineno">  559</span>      result = <a class="code hl_function" href="classPenetrationThread.html#afc662dabb507ed7cdbd573eb7c27c13c">competeInteractionsBothOnFace</a>(pi1, pi2);</div>
<div class="line"><span class="lineno">  560</span>  }</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  563</span>}</div>
<div class="ttc" id="aMooseError_8h_html_aa959168eed29caa7aaa85ffc1319a9ad"><div class="ttname"><a href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a></div><div class="ttdeci">void mooseError(Args &amp;&amp;... args)</div><div class="ttdoc">Emit an error message with the given stringified, concatenated args and terminate the application.</div><div class="ttdef"><b>Definition:</b> <a href="MooseError_8h_source.html#l00284">MooseError.h:284</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a047ec8801894440eb54cddb74e0783a4"><div class="ttname"><a href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">PenetrationInfo::_off_edge_nodes</a></div><div class="ttdeci">std::vector&lt; const Node * &gt; _off_edge_nodes</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00081">PenetrationInfo.h:81</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ad8f5014719cb16ff7af2c6683b68a290"><div class="ttname"><a href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">PenetrationInfo::_tangential_distance</a></div><div class="ttdeci">Real _tangential_distance</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00077">PenetrationInfo.h:77</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a9701265e89432ca9f5692952af8b068a"><div class="ttname"><a href="classPenetrationThread.html#a9701265e89432ca9f5692952af8b068a">PenetrationThread::interactionsOffCommonEdge</a></div><div class="ttdeci">CommonEdgeResult interactionsOffCommonEdge(PenetrationInfo *pi1, PenetrationInfo *pi2)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00597">PenetrationThread.C:597</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_abbdfcaf4eef16f85971bf60a7819064f"><div class="ttname"><a href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">PenetrationThread::CommonEdgeResult</a></div><div class="ttdeci">CommonEdgeResult</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00098">PenetrationThread.h:99</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ac798f14b005d69d51f3075930607d206"><div class="ttname"><a href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">PenetrationThread::CompeteInteractionResult</a></div><div class="ttdeci">CompeteInteractionResult</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00091">PenetrationThread.h:92</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_afc662dabb507ed7cdbd573eb7c27c13c"><div class="ttname"><a href="classPenetrationThread.html#afc662dabb507ed7cdbd573eb7c27c13c">PenetrationThread::competeInteractionsBothOnFace</a></div><div class="ttdeci">CompeteInteractionResult competeInteractionsBothOnFace(PenetrationInfo *pi1, PenetrationInfo *pi2)</div><div class="ttdoc">Determine whether first (pi1) or second (pi2) interaction is stronger when it is known that the node ...</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00566">PenetrationThread.C:566</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="afc662dabb507ed7cdbd573eb7c27c13c" name="afc662dabb507ed7cdbd573eb7c27c13c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc662dabb507ed7cdbd573eb7c27c13c">&#9670;&#160;</a></span>competeInteractionsBothOnFace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">PenetrationThread::CompeteInteractionResult</a> PenetrationThread::competeInteractionsBothOnFace </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine whether first (pi1) or second (pi2) interaction is stronger when it is known that the node projects to both of the two competing faces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pi1</td><td>Pointer to the <a class="el" href="classPenetrationInfo.html" title="Data structure used to hold penetration information.">PenetrationInfo</a> object for the first face </td></tr>
    <tr><td class="paramname">pi2</td><td>Pointer to the <a class="el" href="classPenetrationInfo.html" title="Data structure used to hold penetration information.">PenetrationInfo</a> object for the second face </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Appropriate ComputeInterationResult enum entry identifying which face is a better match </dd></dl>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00566">566</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  567</span>{</div>
<div class="line"><span class="lineno">  568</span>  <a class="code hl_enumeration" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a> result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>;</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>  <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> &gt;= 0.0 &amp;&amp; pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> &lt; 0.0)</div>
<div class="line"><span class="lineno">  571</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>; <span class="comment">// favor face with positive distance (penetrated) -- first in this case</span></div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> &gt;= 0.0 &amp;&amp; pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> &lt; 0.0)</div>
<div class="line"><span class="lineno">  574</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>; <span class="comment">// favor face with positive distance (penetrated) -- second in this case</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>  <span class="comment">// TODO: This logic below could cause an abrupt jump from one face to the other with small mesh</span></div>
<div class="line"><span class="lineno">  577</span>  <span class="comment">//       movement.  If there is some way to smooth the transition, we should do it.</span></div>
<div class="line"><span class="lineno">  578</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceMooseUtils.html#a20ef7a4786a72ca3d0e1d3d589cafead">MooseUtils::relativeFuzzyLessThan</a>(std::abs(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a>), std::abs(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a>)))</div>
<div class="line"><span class="lineno">  579</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>; <span class="comment">// otherwise, favor the closer face -- first in this case</span></div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="namespaceMooseUtils.html#a20ef7a4786a72ca3d0e1d3d589cafead">MooseUtils::relativeFuzzyLessThan</a>(std::abs(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a>), std::abs(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a>)))</div>
<div class="line"><span class="lineno">  582</span>    result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>; <span class="comment">// otherwise, favor the closer face -- second in this case</span></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>  <span class="keywordflow">else</span> <span class="comment">// Equal within tolerance.  Favor the one with a smaller element id (for repeatibility)</span></div>
<div class="line"><span class="lineno">  585</span>  {</div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordflow">if</span> (pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">_elem</a>-&gt;id() &lt; pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">_elem</a>-&gt;id())</div>
<div class="line"><span class="lineno">  587</span>      result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  590</span>      result = <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>;</div>
<div class="line"><span class="lineno">  591</span>  }</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  594</span>}</div>
<div class="ttc" id="aclassPenetrationInfo_html_aa65d6b06caaa791e2c46565e90b7c655"><div class="ttname"><a href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">PenetrationInfo::_elem</a></div><div class="ttdeci">const Elem * _elem</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00072">PenetrationInfo.h:72</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ac9e910ef0e1b0b8ffa04ab432257bc7a"><div class="ttname"><a href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">PenetrationInfo::_distance</a></div><div class="ttdeci">Real _distance</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00076">PenetrationInfo.h:76</a></div></div>
<div class="ttc" id="anamespaceMooseUtils_html_a20ef7a4786a72ca3d0e1d3d589cafead"><div class="ttname"><a href="namespaceMooseUtils.html#a20ef7a4786a72ca3d0e1d3d589cafead">MooseUtils::relativeFuzzyLessThan</a></div><div class="ttdeci">bool relativeFuzzyLessThan(const T &amp;var1, const T2 &amp;var2, const T3 &amp;tol=libMesh::TOLERANCE *libMesh::TOLERANCE)</div><div class="ttdoc">Function to check whether a variable is less than another variable within a relative tolerance.</div><div class="ttdef"><b>Definition:</b> <a href="MooseUtils_8h_source.html#l00578">MooseUtils.h:578</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00505">competeInteractions()</a>.</p>

</div>
</div>
<a id="aa200ad4fed9a188c3e5a7287881ed673" name="aa200ad4fed9a188c3e5a7287881ed673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa200ad4fed9a188c3e5a7287881ed673">&#9670;&#160;</a></span>computeSlip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::computeSlip </td>
          <td>(</td>
          <td class="paramtype">FEBase &amp;&#160;</td>
          <td class="paramname"><em>fe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01214">1214</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1215</span>{</div>
<div class="line"><span class="lineno"> 1216</span>  <span class="comment">// Slip is current projected position of secondary node minus</span></div>
<div class="line"><span class="lineno"> 1217</span>  <span class="comment">//   original projected position of secondary node</span></div>
<div class="line"><span class="lineno"> 1218</span>  std::vector&lt;Point&gt; points(1);</div>
<div class="line"><span class="lineno"> 1219</span>  points[0] = info.<a class="code hl_variable" href="classPenetrationInfo.html#adb3f85f95068b2dbd9d348e4913b896e">_starting_closest_point_ref</a>;</div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keyword">const</span> <span class="keyword">auto</span> &amp; side = <a class="code hl_variable" href="classPenetrationThread.html#afed2112a71c151ab10f9e2ece58ed1d5">_elem_side_builder</a>(*info.<a class="code hl_variable" href="classPenetrationInfo.html#ab3f35e6528f94c33b4aa14c5653a0a92">_starting_elem</a>, info.<a class="code hl_variable" href="classPenetrationInfo.html#a9c3074885aedfb1cee28977259f11d18">_starting_side_num</a>);</div>
<div class="line"><span class="lineno"> 1221</span>  fe.reinit(&amp;side, &amp;points);</div>
<div class="line"><span class="lineno"> 1222</span>  <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; starting_point = fe.get_xyz();</div>
<div class="line"><span class="lineno"> 1223</span>  info.<a class="code hl_variable" href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">_incremental_slip</a> = info.<a class="code hl_variable" href="classPenetrationInfo.html#a466639c3ce38a164243183a47518efb5">_closest_point</a> - starting_point[0];</div>
<div class="line"><span class="lineno"> 1224</span>  <span class="keywordflow">if</span> (info.<a class="code hl_function" href="classPenetrationInfo.html#ab74f6822f49072c16b21c24e59020b0b">isCaptured</a>())</div>
<div class="line"><span class="lineno"> 1225</span>  {</div>
<div class="line"><span class="lineno"> 1226</span>    info.<a class="code hl_variable" href="classPenetrationInfo.html#a08b7ec7615dfb68b7becc783dc1b395f">_frictional_energy</a> =</div>
<div class="line"><span class="lineno"> 1227</span>        info.<a class="code hl_variable" href="classPenetrationInfo.html#a30710f44a73168be4b3134d27ced5dac">_frictional_energy_old</a> + info.<a class="code hl_variable" href="classPenetrationInfo.html#a79bb7287c2e0fe5e7975c1b79b4c166f">_contact_force</a> * info.<a class="code hl_variable" href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">_incremental_slip</a>;</div>
<div class="line"><span class="lineno"> 1228</span>    info.<a class="code hl_variable" href="classPenetrationInfo.html#ac1eed861272a6dc69061c81637f69bfc">_accumulated_slip</a> = info.<a class="code hl_variable" href="classPenetrationInfo.html#a12aa7fc76c20ce38e6293c3df0417e89">_accumulated_slip_old</a> + info.<a class="code hl_variable" href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">_incremental_slip</a>.norm();</div>
<div class="line"><span class="lineno"> 1229</span>  }</div>
<div class="line"><span class="lineno"> 1230</span>}</div>
<div class="ttc" id="aclassPenetrationInfo_html_a08b7ec7615dfb68b7becc783dc1b395f"><div class="ttname"><a href="classPenetrationInfo.html#a08b7ec7615dfb68b7becc783dc1b395f">PenetrationInfo::_frictional_energy</a></div><div class="ttdeci">Real _frictional_energy</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00093">PenetrationInfo.h:93</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a12aa7fc76c20ce38e6293c3df0417e89"><div class="ttname"><a href="classPenetrationInfo.html#a12aa7fc76c20ce38e6293c3df0417e89">PenetrationInfo::_accumulated_slip_old</a></div><div class="ttdeci">Real _accumulated_slip_old</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00092">PenetrationInfo.h:92</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a30710f44a73168be4b3134d27ced5dac"><div class="ttname"><a href="classPenetrationInfo.html#a30710f44a73168be4b3134d27ced5dac">PenetrationInfo::_frictional_energy_old</a></div><div class="ttdeci">Real _frictional_energy_old</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00094">PenetrationInfo.h:94</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a466639c3ce38a164243183a47518efb5"><div class="ttname"><a href="classPenetrationInfo.html#a466639c3ce38a164243183a47518efb5">PenetrationInfo::_closest_point</a></div><div class="ttdeci">Point _closest_point</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00078">PenetrationInfo.h:78</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a79bb7287c2e0fe5e7975c1b79b4c166f"><div class="ttname"><a href="classPenetrationInfo.html#a79bb7287c2e0fe5e7975c1b79b4c166f">PenetrationInfo::_contact_force</a></div><div class="ttdeci">RealVectorValue _contact_force</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00095">PenetrationInfo.h:95</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a905e9bc1e7096dbb30a581e2e7ae9a7b"><div class="ttname"><a href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">PenetrationInfo::_incremental_slip</a></div><div class="ttdeci">Point _incremental_slip</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00090">PenetrationInfo.h:90</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a9c3074885aedfb1cee28977259f11d18"><div class="ttname"><a href="classPenetrationInfo.html#a9c3074885aedfb1cee28977259f11d18">PenetrationInfo::_starting_side_num</a></div><div class="ttdeci">unsigned int _starting_side_num</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00088">PenetrationInfo.h:88</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ab3f35e6528f94c33b4aa14c5653a0a92"><div class="ttname"><a href="classPenetrationInfo.html#ab3f35e6528f94c33b4aa14c5653a0a92">PenetrationInfo::_starting_elem</a></div><div class="ttdeci">const Elem * _starting_elem</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00087">PenetrationInfo.h:87</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ab74f6822f49072c16b21c24e59020b0b"><div class="ttname"><a href="classPenetrationInfo.html#ab74f6822f49072c16b21c24e59020b0b">PenetrationInfo::isCaptured</a></div><div class="ttdeci">bool isCaptured() const</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00064">PenetrationInfo.h:64</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ac1eed861272a6dc69061c81637f69bfc"><div class="ttname"><a href="classPenetrationInfo.html#ac1eed861272a6dc69061c81637f69bfc">PenetrationInfo::_accumulated_slip</a></div><div class="ttdeci">Real _accumulated_slip</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00091">PenetrationInfo.h:91</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_adb3f85f95068b2dbd9d348e4913b896e"><div class="ttname"><a href="classPenetrationInfo.html#adb3f85f95068b2dbd9d348e4913b896e">PenetrationInfo::_starting_closest_point_ref</a></div><div class="ttdeci">Point _starting_closest_point_ref</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00089">PenetrationInfo.h:89</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_afed2112a71c151ab10f9e2ece58ed1d5"><div class="ttname"><a href="classPenetrationThread.html#afed2112a71c151ab10f9e2ece58ed1d5">PenetrationThread::_elem_side_builder</a></div><div class="ttdeci">ElemSideBuilder _elem_side_builder</div><div class="ttdoc">Helper for building element sides without extraneous allocation.</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00089">PenetrationThread.h:89</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a0a5e021c838e9000723e640ebfb98b20" name="a0a5e021c838e9000723e640ebfb98b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a5e021c838e9000723e640ebfb98b20">&#9670;&#160;</a></span>createInfoForElem()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::createInfoForElem </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>thisElemInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node *&#160;</td>
          <td class="paramname"><em>secondary_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; const Node * &gt; &amp;&#160;</td>
          <td class="paramname"><em>nodes_that_must_be_on_side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>check_whether_reasonable</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01632">1632</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1638</span>{</div>
<div class="line"><span class="lineno"> 1639</span>  std::vector&lt;unsigned int&gt; sides;</div>
<div class="line"><span class="lineno"> 1640</span>  <span class="comment">// TODO: After libMesh update, add this line to MooseMesh.h, call sidesWithBoundaryID,  delete</span></div>
<div class="line"><span class="lineno"> 1641</span>  <span class="comment">// getSidesOnPrimaryBoundary, and delete vectors used by it</span></div>
<div class="line"><span class="lineno"> 1642</span>  <span class="comment">//  void sidesWithBoundaryID(std::vector&lt;unsigned int&gt;&amp; sides, const Elem * const elem, const</span></div>
<div class="line"><span class="lineno"> 1643</span>  <span class="comment">//  BoundaryID boundary_id) const</span></div>
<div class="line"><span class="lineno"> 1644</span>  <span class="comment">// {</span></div>
<div class="line"><span class="lineno"> 1645</span>  <span class="comment">//   _mesh.get_boundary_info().sides_with_boundary_id(sides, elem, boundary_id);</span></div>
<div class="line"><span class="lineno"> 1646</span>  <span class="comment">// }</span></div>
<div class="line"><span class="lineno"> 1647</span>  <a class="code hl_function" href="classPenetrationThread.html#ab3556d66260ef56dcf6cac6219de7cb7">getSidesOnPrimaryBoundary</a>(sides, elem);</div>
<div class="line"><span class="lineno"> 1648</span>  <span class="comment">// _mesh.sidesWithBoundaryID(sides, elem, _primary_boundary);</span></div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; sides.size(); ++i)</div>
<div class="line"><span class="lineno"> 1651</span>  {</div>
<div class="line"><span class="lineno"> 1652</span>    <span class="comment">// Don&#39;t create info for this side if one already exists</span></div>
<div class="line"><span class="lineno"> 1653</span>    <span class="keywordtype">bool</span> already_have_info_this_side = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1654</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pi : thisElemInfo)</div>
<div class="line"><span class="lineno"> 1655</span>      <span class="keywordflow">if</span> (pi-&gt;_side_num == sides[i])</div>
<div class="line"><span class="lineno"> 1656</span>      {</div>
<div class="line"><span class="lineno"> 1657</span>        already_have_info_this_side = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1658</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1659</span>      }</div>
<div class="line"><span class="lineno"> 1660</span> </div>
<div class="line"><span class="lineno"> 1661</span>    <span class="keywordflow">if</span> (already_have_info_this_side)</div>
<div class="line"><span class="lineno"> 1662</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1663</span> </div>
<div class="line"><span class="lineno"> 1664</span>    <span class="keyword">const</span> Elem * side = (elem-&gt;build_side_ptr(sides[i], <span class="keyword">false</span>)).release();</div>
<div class="line"><span class="lineno"> 1665</span> </div>
<div class="line"><span class="lineno"> 1666</span>    <span class="comment">// Only continue with creating info for this side if the side contains</span></div>
<div class="line"><span class="lineno"> 1667</span>    <span class="comment">// all of the nodes in nodes_that_must_be_on_side</span></div>
<div class="line"><span class="lineno"> 1668</span>    std::vector&lt;const Node *&gt; nodevec;</div>
<div class="line"><span class="lineno"> 1669</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ni = 0; ni &lt; side-&gt;n_nodes(); ++ni)</div>
<div class="line"><span class="lineno"> 1670</span>      nodevec.push_back(side-&gt;node_ptr(ni));</div>
<div class="line"><span class="lineno"> 1671</span> </div>
<div class="line"><span class="lineno"> 1672</span>    std::sort(nodevec.begin(), nodevec.end());</div>
<div class="line"><span class="lineno"> 1673</span>    std::vector&lt;const Node *&gt; common_nodes;</div>
<div class="line"><span class="lineno"> 1674</span>    std::set_intersection(nodes_that_must_be_on_side.begin(),</div>
<div class="line"><span class="lineno"> 1675</span>                          nodes_that_must_be_on_side.end(),</div>
<div class="line"><span class="lineno"> 1676</span>                          nodevec.begin(),</div>
<div class="line"><span class="lineno"> 1677</span>                          nodevec.end(),</div>
<div class="line"><span class="lineno"> 1678</span>                          std::inserter(common_nodes, common_nodes.end()));</div>
<div class="line"><span class="lineno"> 1679</span>    <span class="keywordflow">if</span> (common_nodes.size() != nodes_that_must_be_on_side.size())</div>
<div class="line"><span class="lineno"> 1680</span>    {</div>
<div class="line"><span class="lineno"> 1681</span>      <span class="keyword">delete</span> side;</div>
<div class="line"><span class="lineno"> 1682</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1683</span>    }</div>
<div class="line"><span class="lineno"> 1684</span> </div>
<div class="line"><span class="lineno"> 1685</span>    <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_elem = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][elem-&gt;dim()];</div>
<div class="line"><span class="lineno"> 1686</span>    <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_side = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][side-&gt;dim()];</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>    <span class="comment">// Optionally check to see whether face is reasonable candidate based on an</span></div>
<div class="line"><span class="lineno"> 1689</span>    <span class="comment">// estimate of how closely it is likely to project to the face</span></div>
<div class="line"><span class="lineno"> 1690</span>    <span class="keywordflow">if</span> (check_whether_reasonable)</div>
<div class="line"><span class="lineno"> 1691</span>      <span class="keywordflow">if</span> (!<a class="code hl_function" href="classPenetrationThread.html#adee847f1d95b90693e8ce87e62aaba69">isFaceReasonableCandidate</a>(elem, side, fe_side, secondary_node, <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>))</div>
<div class="line"><span class="lineno"> 1692</span>      {</div>
<div class="line"><span class="lineno"> 1693</span>        <span class="keyword">delete</span> side;</div>
<div class="line"><span class="lineno"> 1694</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1695</span>      }</div>
<div class="line"><span class="lineno"> 1696</span> </div>
<div class="line"><span class="lineno"> 1697</span>    Point contact_phys;</div>
<div class="line"><span class="lineno"> 1698</span>    Point contact_ref;</div>
<div class="line"><span class="lineno"> 1699</span>    Point contact_on_face_ref;</div>
<div class="line"><span class="lineno"> 1700</span>    Real distance = 0.;</div>
<div class="line"><span class="lineno"> 1701</span>    Real tangential_distance = 0.;</div>
<div class="line"><span class="lineno"> 1702</span>    RealGradient normal;</div>
<div class="line"><span class="lineno"> 1703</span>    <span class="keywordtype">bool</span> contact_point_on_side;</div>
<div class="line"><span class="lineno"> 1704</span>    std::vector&lt;const Node *&gt; off_edge_nodes;</div>
<div class="line"><span class="lineno"> 1705</span>    std::vector&lt;std::vector&lt;Real&gt;&gt; side_phi;</div>
<div class="line"><span class="lineno"> 1706</span>    std::vector&lt;std::vector&lt;RealGradient&gt;&gt; side_grad_phi;</div>
<div class="line"><span class="lineno"> 1707</span>    std::vector&lt;RealGradient&gt; dxyzdxi;</div>
<div class="line"><span class="lineno"> 1708</span>    std::vector&lt;RealGradient&gt; dxyzdeta;</div>
<div class="line"><span class="lineno"> 1709</span>    std::vector&lt;RealGradient&gt; d2xyzdxideta;</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a> * pen_info = <span class="keyword">new</span> <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a>(elem,</div>
<div class="line"><span class="lineno"> 1712</span>                                                     side,</div>
<div class="line"><span class="lineno"> 1713</span>                                                     sides[i],</div>
<div class="line"><span class="lineno"> 1714</span>                                                     normal,</div>
<div class="line"><span class="lineno"> 1715</span>                                                     distance,</div>
<div class="line"><span class="lineno"> 1716</span>                                                     tangential_distance,</div>
<div class="line"><span class="lineno"> 1717</span>                                                     contact_phys,</div>
<div class="line"><span class="lineno"> 1718</span>                                                     contact_ref,</div>
<div class="line"><span class="lineno"> 1719</span>                                                     contact_on_face_ref,</div>
<div class="line"><span class="lineno"> 1720</span>                                                     off_edge_nodes,</div>
<div class="line"><span class="lineno"> 1721</span>                                                     side_phi,</div>
<div class="line"><span class="lineno"> 1722</span>                                                     side_grad_phi,</div>
<div class="line"><span class="lineno"> 1723</span>                                                     dxyzdxi,</div>
<div class="line"><span class="lineno"> 1724</span>                                                     dxyzdeta,</div>
<div class="line"><span class="lineno"> 1725</span>                                                     d2xyzdxideta);</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>    <a class="code hl_function" href="namespaceMoose.html#a89353d7afa7eb5922767ae545cd98b85">Moose::findContactPoint</a>(*pen_info,</div>
<div class="line"><span class="lineno"> 1728</span>                            fe_elem,</div>
<div class="line"><span class="lineno"> 1729</span>                            fe_side,</div>
<div class="line"><span class="lineno"> 1730</span>                            <a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>,</div>
<div class="line"><span class="lineno"> 1731</span>                            *secondary_node,</div>
<div class="line"><span class="lineno"> 1732</span>                            <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 1733</span>                            <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>,</div>
<div class="line"><span class="lineno"> 1734</span>                            contact_point_on_side);</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>    thisElemInfo.push_back(pen_info);</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>    p_info.push_back(pen_info);</div>
<div class="line"><span class="lineno"> 1739</span>  }</div>
<div class="line"><span class="lineno"> 1740</span>}</div>
<div class="ttc" id="aclassPenetrationInfo_html"><div class="ttname"><a href="classPenetrationInfo.html">PenetrationInfo</a></div><div class="ttdoc">Data structure used to hold penetration information.</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00029">PenetrationInfo.h:30</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a1c19836ab3ed65b2aa57ce8e022bcf98"><div class="ttname"><a href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">PenetrationThread::_tid</a></div><div class="ttdeci">THREAD_ID _tid</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00086">PenetrationThread.h:86</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ab3556d66260ef56dcf6cac6219de7cb7"><div class="ttname"><a href="classPenetrationThread.html#ab3556d66260ef56dcf6cac6219de7cb7">PenetrationThread::getSidesOnPrimaryBoundary</a></div><div class="ttdeci">void getSidesOnPrimaryBoundary(std::vector&lt; unsigned int &gt; &amp;sides, const Elem *const elem)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01745">PenetrationThread.C:1745</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_adee847f1d95b90693e8ce87e62aaba69"><div class="ttname"><a href="classPenetrationThread.html#adee847f1d95b90693e8ce87e62aaba69">PenetrationThread::isFaceReasonableCandidate</a></div><div class="ttdeci">bool isFaceReasonableCandidate(const Elem *primary_elem, const Elem *side, FEBase *fe, const Point *secondary_point, const Real tangential_tolerance)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01148">PenetrationThread.C:1148</a></div></div>
<div class="ttc" id="anamespaceMoose_html_a89353d7afa7eb5922767ae545cd98b85"><div class="ttname"><a href="namespaceMoose.html#a89353d7afa7eb5922767ae545cd98b85">Moose::findContactPoint</a></div><div class="ttdeci">void findContactPoint(PenetrationInfo &amp;p_info, FEBase *fe_elem, FEBase *fe_side, FEType &amp;fe_side_type, const Point &amp;secondary_point, bool start_with_centroid, const Real tangential_tolerance, bool &amp;contact_point_on_side)</div><div class="ttdoc">Finds the closest point (called the contact point) on the primary_elem on side &quot;side&quot; to the secondar...</div><div class="ttdef"><b>Definition:</b> <a href="FindContactPoint_8C_source.html#l00045">FindContactPoint.C:45</a></div></div>
<div class="ttc" id="anamespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="Assembly_8h_source.html#l00041">Assembly.h:41</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01527">getInfoForFacesWithCommonNodes()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="afed2aedb63399dd31f62684d459c6494" name="afed2aedb63399dd31f62684d459c6494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed2aedb63399dd31f62684d459c6494">&#9670;&#160;</a></span>findRidgeContactPoint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::findRidgeContactPoint </td>
          <td>(</td>
          <td class="paramtype">Point &amp;&#160;</td>
          <td class="paramname"><em>contact_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real &amp;&#160;</td>
          <td class="paramname"><em>tangential_distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node *&amp;&#160;</td>
          <td class="paramname"><em>closest_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Point &amp;&#160;</td>
          <td class="paramname"><em>contact_point_ref</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>index2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00651">651</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  659</span>{</div>
<div class="line"><span class="lineno">  660</span>  tangential_distance = 0.0;</div>
<div class="line"><span class="lineno">  661</span>  closest_node = NULL;</div>
<div class="line"><span class="lineno">  662</span>  <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a> * pi1 = p_info[index1];</div>
<div class="line"><span class="lineno">  663</span>  <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a> * pi2 = p_info[index2];</div>
<div class="line"><span class="lineno">  664</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sidedim(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim());</div>
<div class="line"><span class="lineno">  665</span>  mooseAssert(sidedim == pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim(), <span class="stringliteral">&quot;Incompatible dimensionalities&quot;</span>);</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>  <span class="comment">// Nodes on faces for the two interactions</span></div>
<div class="line"><span class="lineno">  668</span>  std::vector&lt;const Node *&gt; side1_nodes;</div>
<div class="line"><span class="lineno">  669</span>  <a class="code hl_function" href="classPenetrationThread.html#a613ea76c025bb0e6b137795dc77a3561">getSideCornerNodes</a>(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, side1_nodes);</div>
<div class="line"><span class="lineno">  670</span>  std::vector&lt;const Node *&gt; side2_nodes;</div>
<div class="line"><span class="lineno">  671</span>  <a class="code hl_function" href="classPenetrationThread.html#a613ea76c025bb0e6b137795dc77a3561">getSideCornerNodes</a>(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, side2_nodes);</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>  std::sort(side1_nodes.begin(), side1_nodes.end());</div>
<div class="line"><span class="lineno">  674</span>  std::sort(side2_nodes.begin(), side2_nodes.end());</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>  <span class="comment">// Find nodes shared by the two faces</span></div>
<div class="line"><span class="lineno">  677</span>  std::vector&lt;const Node *&gt; common_nodes;</div>
<div class="line"><span class="lineno">  678</span>  std::set_intersection(side1_nodes.begin(),</div>
<div class="line"><span class="lineno">  679</span>                        side1_nodes.end(),</div>
<div class="line"><span class="lineno">  680</span>                        side2_nodes.begin(),</div>
<div class="line"><span class="lineno">  681</span>                        side2_nodes.end(),</div>
<div class="line"><span class="lineno">  682</span>                        std::inserter(common_nodes, common_nodes.end()));</div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>  <span class="keywordflow">if</span> (common_nodes.size() != sidedim)</div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>  <span class="keywordtype">bool</span> found_point1, found_point2;</div>
<div class="line"><span class="lineno">  688</span>  Point closest_coor_ref1(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a>);</div>
<div class="line"><span class="lineno">  689</span>  <span class="keyword">const</span> Node * closest_node1;</div>
<div class="line"><span class="lineno">  690</span>  found_point1 = <a class="code hl_function" href="classPenetrationThread.html#aa865ac60b45804ace8ddefe9333c0c7b">restrictPointToSpecifiedEdgeOfFace</a>(</div>
<div class="line"><span class="lineno">  691</span>      closest_coor_ref1, closest_node1, pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, common_nodes);</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  Point closest_coor_ref2(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a>);</div>
<div class="line"><span class="lineno">  694</span>  <span class="keyword">const</span> Node * closest_node2;</div>
<div class="line"><span class="lineno">  695</span>  found_point2 = <a class="code hl_function" href="classPenetrationThread.html#aa865ac60b45804ace8ddefe9333c0c7b">restrictPointToSpecifiedEdgeOfFace</a>(</div>
<div class="line"><span class="lineno">  696</span>      closest_coor_ref2, closest_node2, pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, common_nodes);</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>  <span class="keywordflow">if</span> (!found_point1 || !found_point2)</div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>  <span class="comment">//  if (sidedim == 2)</span></div>
<div class="line"><span class="lineno">  702</span>  <span class="comment">//  {</span></div>
<div class="line"><span class="lineno">  703</span>  <span class="comment">// TODO:</span></div>
<div class="line"><span class="lineno">  704</span>  <span class="comment">// We have the parametric coordinates of the closest intersection point for both faces.</span></div>
<div class="line"><span class="lineno">  705</span>  <span class="comment">// We need to find a point somewhere in the middle of them so there&#39;s not an abrupt jump.</span></div>
<div class="line"><span class="lineno">  706</span>  <span class="comment">// Find that point by taking dot products of vector from contact point to secondary node point</span></div>
<div class="line"><span class="lineno">  707</span>  <span class="comment">// with face normal vectors to see which face we&#39;re closer to.</span></div>
<div class="line"><span class="lineno">  708</span>  <span class="comment">//  }</span></div>
<div class="line"><span class="lineno">  709</span> </div>
<div class="line"><span class="lineno">  710</span>  <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe = NULL;</div>
<div class="line"><span class="lineno">  711</span>  std::vector&lt;Point&gt; points(1);</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>  <span class="comment">// We have to pick one of the two faces to own the contact point.  It doesn&#39;t really matter</span></div>
<div class="line"><span class="lineno">  714</span>  <span class="comment">// which one we pick.  For repeatibility, pick the face with the lowest index.</span></div>
<div class="line"><span class="lineno">  715</span>  <span class="keywordflow">if</span> (index1 &lt; index2)</div>
<div class="line"><span class="lineno">  716</span>  {</div>
<div class="line"><span class="lineno">  717</span>    fe = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim()];</div>
<div class="line"><span class="lineno">  718</span>    contact_point_ref = closest_coor_ref1;</div>
<div class="line"><span class="lineno">  719</span>    points[0] = closest_coor_ref1;</div>
<div class="line"><span class="lineno">  720</span>    fe-&gt;reinit(pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, &amp;points);</div>
<div class="line"><span class="lineno">  721</span>    index = index1;</div>
<div class="line"><span class="lineno">  722</span>  }</div>
<div class="line"><span class="lineno">  723</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  724</span>  {</div>
<div class="line"><span class="lineno">  725</span>    fe = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim()];</div>
<div class="line"><span class="lineno">  726</span>    contact_point_ref = closest_coor_ref2;</div>
<div class="line"><span class="lineno">  727</span>    points[0] = closest_coor_ref2;</div>
<div class="line"><span class="lineno">  728</span>    fe-&gt;reinit(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, &amp;points);</div>
<div class="line"><span class="lineno">  729</span>    index = index2;</div>
<div class="line"><span class="lineno">  730</span>  }</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>  contact_point = fe-&gt;get_xyz()[0];</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>  <span class="keywordflow">if</span> (sidedim == 2)</div>
<div class="line"><span class="lineno">  735</span>  {</div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">if</span> (closest_node1) <span class="comment">// point is off the ridge between the two elements</span></div>
<div class="line"><span class="lineno">  737</span>    {</div>
<div class="line"><span class="lineno">  738</span>      mooseAssert((closest_node1 == closest_node2 || closest_node2 == NULL),</div>
<div class="line"><span class="lineno">  739</span>                  <span class="stringliteral">&quot;If off edge of ridge, closest node must be the same on both elements&quot;</span>);</div>
<div class="line"><span class="lineno">  740</span>      closest_node = closest_node1;</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>      RealGradient off_face = *closest_node1 - contact_point;</div>
<div class="line"><span class="lineno">  743</span>      tangential_distance = off_face.norm();</div>
<div class="line"><span class="lineno">  744</span>    }</div>
<div class="line"><span class="lineno">  745</span>  }</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  748</span>}</div>
<div class="ttc" id="aclassPenetrationInfo_html_a06dc594bc99461c618e5fa2230c90c16"><div class="ttname"><a href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">PenetrationInfo::_side</a></div><div class="ttdeci">const Elem * _side</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00073">PenetrationInfo.h:73</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c"><div class="ttname"><a href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">PenetrationInfo::_closest_point_ref</a></div><div class="ttdeci">Point _closest_point_ref</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00079">PenetrationInfo.h:79</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a613ea76c025bb0e6b137795dc77a3561"><div class="ttname"><a href="classPenetrationThread.html#a613ea76c025bb0e6b137795dc77a3561">PenetrationThread::getSideCornerNodes</a></div><div class="ttdeci">void getSideCornerNodes(const Elem *side, std::vector&lt; const Node * &gt; &amp;corner_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00751">PenetrationThread.C:751</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_aa865ac60b45804ace8ddefe9333c0c7b"><div class="ttname"><a href="classPenetrationThread.html#aa865ac60b45804ace8ddefe9333c0c7b">PenetrationThread::restrictPointToSpecifiedEdgeOfFace</a></div><div class="ttdeci">bool restrictPointToSpecifiedEdgeOfFace(Point &amp;p, const Node *&amp;closest_node, const Elem *side, const std::vector&lt; const Node * &gt; &amp;edge_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00793">PenetrationThread.C:793</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a518757e67583ef5811d889beb5ce1617" name="a518757e67583ef5811d889beb5ce1617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a518757e67583ef5811d889beb5ce1617">&#9670;&#160;</a></span>getInfoForElem()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getInfoForElem </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>thisElemInfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01617">1617</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1620</span>{</div>
<div class="line"><span class="lineno"> 1621</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pi : p_info)</div>
<div class="line"><span class="lineno"> 1622</span>  {</div>
<div class="line"><span class="lineno"> 1623</span>    <span class="keywordflow">if</span> (!pi)</div>
<div class="line"><span class="lineno"> 1624</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keywordflow">if</span> (pi-&gt;_elem == elem)</div>
<div class="line"><span class="lineno"> 1627</span>      thisElemInfo.push_back(pi);</div>
<div class="line"><span class="lineno"> 1628</span>  }</div>
<div class="line"><span class="lineno"> 1629</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01527">getInfoForFacesWithCommonNodes()</a>.</p>

</div>
</div>
<a id="aca3bc5ded9e8d66365af79bea2399617" name="aca3bc5ded9e8d66365af79bea2399617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca3bc5ded9e8d66365af79bea2399617">&#9670;&#160;</a></span>getInfoForFacesWithCommonNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getInfoForFacesWithCommonNodes </td>
          <td>(</td>
          <td class="paramtype">const Node *&#160;</td>
          <td class="paramname"><em>secondary_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; dof_id_type &gt; &amp;&#160;</td>
          <td class="paramname"><em>elems_to_exclude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; const Node * &gt;&#160;</td>
          <td class="paramname"><em>edge_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>face_info_comm_edge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01527">1527</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1533</span>{</div>
<div class="line"><span class="lineno"> 1534</span>  <span class="comment">// elems connected to a node on this edge, find one that has the same corners as this, and is not</span></div>
<div class="line"><span class="lineno"> 1535</span>  <span class="comment">// the current elem</span></div>
<div class="line"><span class="lineno"> 1536</span>  <span class="keyword">auto</span> node_to_elem_pair = <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>.find(edge_nodes[0]-&gt;<span class="keywordtype">id</span>()); <span class="comment">// just need one of the</span></div>
<div class="line"><span class="lineno"> 1537</span>                                                                        <span class="comment">// nodes</span></div>
<div class="line"><span class="lineno"> 1538</span>  mooseAssert(node_to_elem_pair != <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>.end(), <span class="stringliteral">&quot;Missing entry in node to elem map&quot;</span>);</div>
<div class="line"><span class="lineno"> 1539</span>  <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; elems_connected_to_node = node_to_elem_pair-&gt;second;</div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>  std::vector&lt;const Elem *&gt; elems_connected_to_edge;</div>
<div class="line"><span class="lineno"> 1542</span> </div>
<div class="line"><span class="lineno"> 1543</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ecni = 0; ecni &lt; elems_connected_to_node.size(); ecni++)</div>
<div class="line"><span class="lineno"> 1544</span>  {</div>
<div class="line"><span class="lineno"> 1545</span>    <span class="keywordflow">if</span> (elems_to_exclude.find(elems_connected_to_node[ecni]) != elems_to_exclude.end())</div>
<div class="line"><span class="lineno"> 1546</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1547</span>    <span class="keyword">const</span> Elem * elem = <a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>.<a class="code hl_function" href="classMooseMesh.html#a27dd2a8bcd30f81c67449911092cb8f0">elemPtr</a>(elems_connected_to_node[ecni]);</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>    std::vector&lt;const Node *&gt; nodevec;</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ni = 0; ni &lt; elem-&gt;n_nodes(); ++ni)</div>
<div class="line"><span class="lineno"> 1551</span>      <span class="keywordflow">if</span> (elem-&gt;is_vertex(ni))</div>
<div class="line"><span class="lineno"> 1552</span>        nodevec.push_back(elem-&gt;node_ptr(ni));</div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span>    std::vector&lt;const Node *&gt; common_nodes;</div>
<div class="line"><span class="lineno"> 1555</span>    std::sort(nodevec.begin(), nodevec.end());</div>
<div class="line"><span class="lineno"> 1556</span>    std::set_intersection(edge_nodes.begin(),</div>
<div class="line"><span class="lineno"> 1557</span>                          edge_nodes.end(),</div>
<div class="line"><span class="lineno"> 1558</span>                          nodevec.begin(),</div>
<div class="line"><span class="lineno"> 1559</span>                          nodevec.end(),</div>
<div class="line"><span class="lineno"> 1560</span>                          std::inserter(common_nodes, common_nodes.end()));</div>
<div class="line"><span class="lineno"> 1561</span> </div>
<div class="line"><span class="lineno"> 1562</span>    <span class="keywordflow">if</span> (common_nodes.size() == edge_nodes.size())</div>
<div class="line"><span class="lineno"> 1563</span>      elems_connected_to_edge.push_back(elem);</div>
<div class="line"><span class="lineno"> 1564</span>  }</div>
<div class="line"><span class="lineno"> 1565</span> </div>
<div class="line"><span class="lineno"> 1566</span>  <span class="keywordflow">if</span> (elems_connected_to_edge.size() &gt; 0)</div>
<div class="line"><span class="lineno"> 1567</span>  {</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>    <span class="comment">// There are potentially multiple elements that share a common edge</span></div>
<div class="line"><span class="lineno"> 1570</span>    <span class="comment">// 2D:</span></div>
<div class="line"><span class="lineno"> 1571</span>    <span class="comment">// There can only be one element on the same surface</span></div>
<div class="line"><span class="lineno"> 1572</span>    <span class="comment">// 3D:</span></div>
<div class="line"><span class="lineno"> 1573</span>    <span class="comment">// If there are two edge nodes, there can only be one element on the same surface</span></div>
<div class="line"><span class="lineno"> 1574</span>    <span class="comment">// If there is only one edge node (a corner), there could be multiple elements on the same</span></div>
<div class="line"><span class="lineno"> 1575</span>    <span class="comment">// surface</span></div>
<div class="line"><span class="lineno"> 1576</span>    <span class="keywordtype">bool</span> allowMultipleNeighbors = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1577</span> </div>
<div class="line"><span class="lineno"> 1578</span>    <span class="keywordflow">if</span> (elems_connected_to_edge[0]-&gt;dim() == 3)</div>
<div class="line"><span class="lineno"> 1579</span>    {</div>
<div class="line"><span class="lineno"> 1580</span>      <span class="keywordflow">if</span> (edge_nodes.size() == 1)</div>
<div class="line"><span class="lineno"> 1581</span>      {</div>
<div class="line"><span class="lineno"> 1582</span>        allowMultipleNeighbors = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1583</span>      }</div>
<div class="line"><span class="lineno"> 1584</span>    }</div>
<div class="line"><span class="lineno"> 1585</span> </div>
<div class="line"><span class="lineno"> 1586</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; elems_connected_to_edge.size(); ++i)</div>
<div class="line"><span class="lineno"> 1587</span>    {</div>
<div class="line"><span class="lineno"> 1588</span>      std::vector&lt;PenetrationInfo *&gt; thisElemInfo;</div>
<div class="line"><span class="lineno"> 1589</span>      <a class="code hl_function" href="classPenetrationThread.html#a518757e67583ef5811d889beb5ce1617">getInfoForElem</a>(thisElemInfo, p_info, elems_connected_to_edge[i]);</div>
<div class="line"><span class="lineno"> 1590</span>      <span class="keywordflow">if</span> (thisElemInfo.size() &gt; 0 &amp;&amp; !allowMultipleNeighbors)</div>
<div class="line"><span class="lineno"> 1591</span>      {</div>
<div class="line"><span class="lineno"> 1592</span>        <span class="keywordflow">if</span> (thisElemInfo.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 1593</span>          <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(</div>
<div class="line"><span class="lineno"> 1594</span>              <span class="stringliteral">&quot;Found multiple neighbors to current edge/face on surface when only one is allowed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1595</span>        face_info_comm_edge.push_back(thisElemInfo[0]);</div>
<div class="line"><span class="lineno"> 1596</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1597</span>      }</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>      <a class="code hl_function" href="classPenetrationThread.html#a0a5e021c838e9000723e640ebfb98b20">createInfoForElem</a>(</div>
<div class="line"><span class="lineno"> 1600</span>          thisElemInfo, p_info, secondary_node, elems_connected_to_edge[i], edge_nodes);</div>
<div class="line"><span class="lineno"> 1601</span>      <span class="keywordflow">if</span> (thisElemInfo.size() &gt; 0 &amp;&amp; !allowMultipleNeighbors)</div>
<div class="line"><span class="lineno"> 1602</span>      {</div>
<div class="line"><span class="lineno"> 1603</span>        <span class="keywordflow">if</span> (thisElemInfo.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 1604</span>          <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(</div>
<div class="line"><span class="lineno"> 1605</span>              <span class="stringliteral">&quot;Found multiple neighbors to current edge/face on surface when only one is allowed&quot;</span>);</div>
<div class="line"><span class="lineno"> 1606</span>        face_info_comm_edge.push_back(thisElemInfo[0]);</div>
<div class="line"><span class="lineno"> 1607</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1608</span>      }</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; thisElemInfo.size(); ++j)</div>
<div class="line"><span class="lineno"> 1611</span>        face_info_comm_edge.push_back(thisElemInfo[j]);</div>
<div class="line"><span class="lineno"> 1612</span>    }</div>
<div class="line"><span class="lineno"> 1613</span>  }</div>
<div class="line"><span class="lineno"> 1614</span>}</div>
<div class="ttc" id="aclassMooseMesh_html_a27dd2a8bcd30f81c67449911092cb8f0"><div class="ttname"><a href="classMooseMesh.html#a27dd2a8bcd30f81c67449911092cb8f0">MooseMesh::elemPtr</a></div><div class="ttdeci">virtual Elem * elemPtr(const dof_id_type i)</div><div class="ttdef"><b>Definition:</b> <a href="MooseMesh_8C_source.html#l02853">MooseMesh.C:2853</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a0a5e021c838e9000723e640ebfb98b20"><div class="ttname"><a href="classPenetrationThread.html#a0a5e021c838e9000723e640ebfb98b20">PenetrationThread::createInfoForElem</a></div><div class="ttdeci">void createInfoForElem(std::vector&lt; PenetrationInfo * &gt; &amp;thisElemInfo, std::vector&lt; PenetrationInfo * &gt; &amp;p_info, const Node *secondary_node, const Elem *elem, const std::vector&lt; const Node * &gt; &amp;nodes_that_must_be_on_side, const bool check_whether_reasonable=false)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01632">PenetrationThread.C:1632</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a518757e67583ef5811d889beb5ce1617"><div class="ttname"><a href="classPenetrationThread.html#a518757e67583ef5811d889beb5ce1617">PenetrationThread::getInfoForElem</a></div><div class="ttdeci">void getInfoForElem(std::vector&lt; PenetrationInfo * &gt; &amp;thisElemInfo, std::vector&lt; PenetrationInfo * &gt; &amp;p_info, const Elem *elem)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01617">PenetrationThread.C:1617</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01291">getSmoothingFacesAndWeights()</a>.</p>

</div>
</div>
<a id="a613ea76c025bb0e6b137795dc77a3561" name="a613ea76c025bb0e6b137795dc77a3561"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a613ea76c025bb0e6b137795dc77a3561">&#9670;&#160;</a></span>getSideCornerNodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getSideCornerNodes </td>
          <td>(</td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; const Node * &gt; &amp;&#160;</td>
          <td class="paramname"><em>corner_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00751">751</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  752</span>{</div>
<div class="line"><span class="lineno">  753</span>  <span class="keyword">const</span> ElemType t(side-&gt;type());</div>
<div class="line"><span class="lineno">  754</span>  corner_nodes.clear();</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>  corner_nodes.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno">  757</span>  corner_nodes.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno">  758</span>  <span class="keywordflow">switch</span> (t)</div>
<div class="line"><span class="lineno">  759</span>  {</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordflow">case</span> EDGE2:</div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">case</span> EDGE3:</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordflow">case</span> EDGE4:</div>
<div class="line"><span class="lineno">  763</span>    {</div>
<div class="line"><span class="lineno">  764</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  765</span>    }</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keywordflow">case</span> TRI3:</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">case</span> TRI6:</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">case</span> TRI7:</div>
<div class="line"><span class="lineno">  770</span>    {</div>
<div class="line"><span class="lineno">  771</span>      corner_nodes.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno">  772</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  773</span>    }</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">case</span> QUAD4:</div>
<div class="line"><span class="lineno">  776</span>    <span class="keywordflow">case</span> QUAD8:</div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordflow">case</span> QUAD9:</div>
<div class="line"><span class="lineno">  778</span>    {</div>
<div class="line"><span class="lineno">  779</span>      corner_nodes.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno">  780</span>      corner_nodes.push_back(side-&gt;node_ptr(3));</div>
<div class="line"><span class="lineno">  781</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  782</span>    }</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  785</span>    {</div>
<div class="line"><span class="lineno">  786</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Unsupported face type: &quot;</span>, t);</div>
<div class="line"><span class="lineno">  787</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  788</span>    }</div>
<div class="line"><span class="lineno">  789</span>  }</div>
<div class="line"><span class="lineno">  790</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00651">findRidgeContactPoint()</a>.</p>

</div>
</div>
<a id="ab3556d66260ef56dcf6cac6219de7cb7" name="ab3556d66260ef56dcf6cac6219de7cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3556d66260ef56dcf6cac6219de7cb7">&#9670;&#160;</a></span>getSidesOnPrimaryBoundary()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getSidesOnPrimaryBoundary </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>sides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *const&#160;</td>
          <td class="paramname"><em>elem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01745">1745</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1747</span>{</div>
<div class="line"><span class="lineno"> 1748</span>  <span class="comment">// For each tuple, the fields are (0=elem_id, 1=side_id, 2=bc_id)</span></div>
<div class="line"><span class="lineno"> 1749</span>  sides.clear();</div>
<div class="line"><span class="lineno"> 1750</span>  <span class="keyword">struct </span>Comp</div>
<div class="line"><span class="lineno"> 1751</span>  {</div>
<div class="line"><span class="lineno"> 1752</span>    <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> libMesh::BoundaryInfo::BCTuple &amp; tup, dof_id_type <span class="keywordtype">id</span>)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1753</span><span class="keyword">    </span>{</div>
<div class="line"><span class="lineno"> 1754</span>      <span class="keywordflow">return</span> std::get&lt;0&gt;(tup) &lt; id;</div>
<div class="line"><span class="lineno"> 1755</span>    }</div>
<div class="line"><span class="lineno"> 1756</span>    <span class="keywordtype">bool</span> operator()(dof_id_type <span class="keywordtype">id</span>, <span class="keyword">const</span> libMesh::BoundaryInfo::BCTuple &amp; tup)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1757</span><span class="keyword">    </span>{</div>
<div class="line"><span class="lineno"> 1758</span>      <span class="keywordflow">return</span> id &lt; std::get&lt;0&gt;(tup);</div>
<div class="line"><span class="lineno"> 1759</span>    }</div>
<div class="line"><span class="lineno"> 1760</span>  };</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span>  <span class="keyword">auto</span> range = std::equal_range(<a class="code hl_variable" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a>.begin(), <a class="code hl_variable" href="classPenetrationThread.html#a636421718b7ba96962c4e9d9347476ef">_bc_tuples</a>.end(), elem-&gt;id(), Comp{});</div>
<div class="line"><span class="lineno"> 1763</span> </div>
<div class="line"><span class="lineno"> 1764</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; t = range.first; t != range.second; ++t)</div>
<div class="line"><span class="lineno"> 1765</span>    <span class="keywordflow">if</span> (std::get&lt;2&gt;(*t) == <span class="keyword">static_cast&lt;</span>boundary_id_type<span class="keyword">&gt;</span>(<a class="code hl_variable" href="classPenetrationThread.html#afa5fba35e105afe524a8d54249d3afe8">_primary_boundary</a>))</div>
<div class="line"><span class="lineno"> 1766</span>      sides.push_back(std::get&lt;1&gt;(*t));</div>
<div class="line"><span class="lineno"> 1767</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>.</p>

</div>
</div>
<a id="a95093c8e61d812efc78503a056115fe9" name="a95093c8e61d812efc78503a056115fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95093c8e61d812efc78503a056115fe9">&#9670;&#160;</a></span>getSmoothingEdgeNodesAndWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getSmoothingEdgeNodesAndWeights </td>
          <td>(</td>
          <td class="paramtype">const Point &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; const Node * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_face_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01386">1386</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1391</span>{</div>
<div class="line"><span class="lineno"> 1392</span>  <span class="keyword">const</span> ElemType t(side-&gt;type());</div>
<div class="line"><span class="lineno"> 1393</span>  <span class="keyword">const</span> Real &amp; xi = p(0);</div>
<div class="line"><span class="lineno"> 1394</span>  <span class="keyword">const</span> Real &amp; eta = p(1);</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span>  Real smooth_limit = 1.0 - <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>;</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>  <span class="keywordflow">switch</span> (t)</div>
<div class="line"><span class="lineno"> 1399</span>  {</div>
<div class="line"><span class="lineno"> 1400</span>    <span class="keywordflow">case</span> EDGE2:</div>
<div class="line"><span class="lineno"> 1401</span>    <span class="keywordflow">case</span> EDGE3:</div>
<div class="line"><span class="lineno"> 1402</span>    <span class="keywordflow">case</span> EDGE4:</div>
<div class="line"><span class="lineno"> 1403</span>    {</div>
<div class="line"><span class="lineno"> 1404</span>      <span class="keywordflow">if</span> (xi &lt; -smooth_limit)</div>
<div class="line"><span class="lineno"> 1405</span>      {</div>
<div class="line"><span class="lineno"> 1406</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1407</span>        en.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno"> 1408</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1409</span>        Real fw = 0.5 - (1.0 + xi) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1410</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1411</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1412</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1413</span>      }</div>
<div class="line"><span class="lineno"> 1414</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; smooth_limit)</div>
<div class="line"><span class="lineno"> 1415</span>      {</div>
<div class="line"><span class="lineno"> 1416</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1417</span>        en.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno"> 1418</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1419</span>        Real fw = 0.5 - (1.0 - xi) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1420</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1421</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1422</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1423</span>      }</div>
<div class="line"><span class="lineno"> 1424</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1425</span>    }</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">case</span> TRI3:</div>
<div class="line"><span class="lineno"> 1428</span>    <span class="keywordflow">case</span> TRI6:</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordflow">case</span> TRI7:</div>
<div class="line"><span class="lineno"> 1430</span>    {</div>
<div class="line"><span class="lineno"> 1431</span>      <span class="keywordflow">if</span> (eta &lt; -smooth_limit)</div>
<div class="line"><span class="lineno"> 1432</span>      {</div>
<div class="line"><span class="lineno"> 1433</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1434</span>        en.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno"> 1435</span>        en.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno"> 1436</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1437</span>        Real fw = 0.5 - (1.0 + eta) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1438</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1439</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1440</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1441</span>      }</div>
<div class="line"><span class="lineno"> 1442</span>      <span class="keywordflow">if</span> ((xi + eta) &gt; smooth_limit)</div>
<div class="line"><span class="lineno"> 1443</span>      {</div>
<div class="line"><span class="lineno"> 1444</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1445</span>        en.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno"> 1446</span>        en.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno"> 1447</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1448</span>        Real fw = 0.5 - (1.0 - xi - eta) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1449</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1450</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1451</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1452</span>      }</div>
<div class="line"><span class="lineno"> 1453</span>      <span class="keywordflow">if</span> (xi &lt; -smooth_limit)</div>
<div class="line"><span class="lineno"> 1454</span>      {</div>
<div class="line"><span class="lineno"> 1455</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1456</span>        en.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno"> 1457</span>        en.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno"> 1458</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1459</span>        Real fw = 0.5 - (1.0 + xi) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1460</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1461</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1462</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1463</span>      }</div>
<div class="line"><span class="lineno"> 1464</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1465</span>    }</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>    <span class="keywordflow">case</span> QUAD4:</div>
<div class="line"><span class="lineno"> 1468</span>    <span class="keywordflow">case</span> QUAD8:</div>
<div class="line"><span class="lineno"> 1469</span>    <span class="keywordflow">case</span> QUAD9:</div>
<div class="line"><span class="lineno"> 1470</span>    {</div>
<div class="line"><span class="lineno"> 1471</span>      <span class="keywordflow">if</span> (eta &lt; -smooth_limit)</div>
<div class="line"><span class="lineno"> 1472</span>      {</div>
<div class="line"><span class="lineno"> 1473</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1474</span>        en.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno"> 1475</span>        en.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno"> 1476</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1477</span>        Real fw = 0.5 - (1.0 + eta) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1478</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1479</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1480</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1481</span>      }</div>
<div class="line"><span class="lineno"> 1482</span>      <span class="keywordflow">if</span> (xi &gt; smooth_limit)</div>
<div class="line"><span class="lineno"> 1483</span>      {</div>
<div class="line"><span class="lineno"> 1484</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1485</span>        en.push_back(side-&gt;node_ptr(1));</div>
<div class="line"><span class="lineno"> 1486</span>        en.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno"> 1487</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1488</span>        Real fw = 0.5 - (1.0 - xi) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1489</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1490</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1491</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1492</span>      }</div>
<div class="line"><span class="lineno"> 1493</span>      <span class="keywordflow">if</span> (eta &gt; smooth_limit)</div>
<div class="line"><span class="lineno"> 1494</span>      {</div>
<div class="line"><span class="lineno"> 1495</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1496</span>        en.push_back(side-&gt;node_ptr(2));</div>
<div class="line"><span class="lineno"> 1497</span>        en.push_back(side-&gt;node_ptr(3));</div>
<div class="line"><span class="lineno"> 1498</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1499</span>        Real fw = 0.5 - (1.0 - eta) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1500</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1501</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1502</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1503</span>      }</div>
<div class="line"><span class="lineno"> 1504</span>      <span class="keywordflow">if</span> (xi &lt; -smooth_limit)</div>
<div class="line"><span class="lineno"> 1505</span>      {</div>
<div class="line"><span class="lineno"> 1506</span>        std::vector&lt;const Node *&gt; en;</div>
<div class="line"><span class="lineno"> 1507</span>        en.push_back(side-&gt;node_ptr(3));</div>
<div class="line"><span class="lineno"> 1508</span>        en.push_back(side-&gt;node_ptr(0));</div>
<div class="line"><span class="lineno"> 1509</span>        edge_nodes.push_back(en);</div>
<div class="line"><span class="lineno"> 1510</span>        Real fw = 0.5 - (1.0 + xi) / (2.0 * <a class="code hl_variable" href="classPenetrationThread.html#ac9bd6652bbfa243effaa2c88f21c9582">_normal_smoothing_distance</a>);</div>
<div class="line"><span class="lineno"> 1511</span>        <span class="keywordflow">if</span> (fw &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1512</span>          fw = 0.5;</div>
<div class="line"><span class="lineno"> 1513</span>        edge_face_weights.push_back(fw);</div>
<div class="line"><span class="lineno"> 1514</span>      }</div>
<div class="line"><span class="lineno"> 1515</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1516</span>    }</div>
<div class="line"><span class="lineno"> 1517</span> </div>
<div class="line"><span class="lineno"> 1518</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1519</span>    {</div>
<div class="line"><span class="lineno"> 1520</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Unsupported face type: &quot;</span>, t);</div>
<div class="line"><span class="lineno"> 1521</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1522</span>    }</div>
<div class="line"><span class="lineno"> 1523</span>  }</div>
<div class="line"><span class="lineno"> 1524</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01291">getSmoothingFacesAndWeights()</a>.</p>

</div>
</div>
<a id="aec2a4106b14e45786a65d2ce6b5fae96" name="aec2a4106b14e45786a65d2ce6b5fae96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec2a4106b14e45786a65d2ce6b5fae96">&#9670;&#160;</a></span>getSmoothingFacesAndWeights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::getSmoothingFacesAndWeights </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_face_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_face_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node &amp;&#160;</td>
          <td class="paramname"><em>secondary_node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01291">1291</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1296</span>{</div>
<div class="line"><span class="lineno"> 1297</span>  <span class="keyword">const</span> Elem * side = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>;</div>
<div class="line"><span class="lineno"> 1298</span>  <span class="keyword">const</span> Point &amp; p = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a>;</div>
<div class="line"><span class="lineno"> 1299</span>  std::set&lt;dof_id_type&gt; elems_to_exclude;</div>
<div class="line"><span class="lineno"> 1300</span>  elems_to_exclude.insert(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">_elem</a>-&gt;id());</div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>  std::vector&lt;std::vector&lt;const Node *&gt;&gt; edge_nodes;</div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>  <span class="comment">// Get the pairs of nodes along every edge that we are close enough to smooth with</span></div>
<div class="line"><span class="lineno"> 1305</span>  <a class="code hl_function" href="classPenetrationThread.html#a95093c8e61d812efc78503a056115fe9">getSmoothingEdgeNodesAndWeights</a>(p, side, edge_nodes, edge_face_weights);</div>
<div class="line"><span class="lineno"> 1306</span>  std::vector&lt;Elem *&gt; edge_neighbor_elems;</div>
<div class="line"><span class="lineno"> 1307</span>  edge_face_info.resize(edge_nodes.size(), NULL);</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  std::vector&lt;unsigned int&gt; edges_without_neighbors;</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; edge_nodes.size(); ++i)</div>
<div class="line"><span class="lineno"> 1312</span>  {</div>
<div class="line"><span class="lineno"> 1313</span>    <span class="comment">// Sort all sets of edge nodes (needed for comparing edges)</span></div>
<div class="line"><span class="lineno"> 1314</span>    std::sort(edge_nodes[i].begin(), edge_nodes[i].end());</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>    std::vector&lt;PenetrationInfo *&gt; face_info_comm_edge;</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_function" href="classPenetrationThread.html#aca3bc5ded9e8d66365af79bea2399617">getInfoForFacesWithCommonNodes</a>(</div>
<div class="line"><span class="lineno"> 1318</span>        &amp;secondary_node, elems_to_exclude, edge_nodes[i], face_info_comm_edge, p_info);</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>    <span class="keywordflow">if</span> (face_info_comm_edge.size() == 0)</div>
<div class="line"><span class="lineno"> 1321</span>      edges_without_neighbors.push_back(i);</div>
<div class="line"><span class="lineno"> 1322</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (face_info_comm_edge.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 1323</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Only one neighbor allowed per edge&quot;</span>);</div>
<div class="line"><span class="lineno"> 1324</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1325</span>      edge_face_info[i] = face_info_comm_edge[0];</div>
<div class="line"><span class="lineno"> 1326</span>  }</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>  <span class="comment">// Remove edges without neighbors from the vector, starting from end</span></div>
<div class="line"><span class="lineno"> 1329</span>  std::vector&lt;unsigned int&gt;::reverse_iterator rit;</div>
<div class="line"><span class="lineno"> 1330</span>  <span class="keywordflow">for</span> (rit = edges_without_neighbors.rbegin(); rit != edges_without_neighbors.rend(); ++rit)</div>
<div class="line"><span class="lineno"> 1331</span>  {</div>
<div class="line"><span class="lineno"> 1332</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = *rit;</div>
<div class="line"><span class="lineno"> 1333</span>    edge_nodes.erase(edge_nodes.begin() + index);</div>
<div class="line"><span class="lineno"> 1334</span>    edge_face_weights.erase(edge_face_weights.begin() + index);</div>
<div class="line"><span class="lineno"> 1335</span>    edge_face_info.erase(edge_face_info.begin() + index);</div>
<div class="line"><span class="lineno"> 1336</span>  }</div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>  <span class="comment">// Handle corner case</span></div>
<div class="line"><span class="lineno"> 1339</span>  <span class="keywordflow">if</span> (edge_nodes.size() &gt; 1)</div>
<div class="line"><span class="lineno"> 1340</span>  {</div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keywordflow">if</span> (edge_nodes.size() != 2)</div>
<div class="line"><span class="lineno"> 1342</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid number of smoothing edges&quot;</span>);</div>
<div class="line"><span class="lineno"> 1343</span> </div>
<div class="line"><span class="lineno"> 1344</span>    <span class="comment">// find common node</span></div>
<div class="line"><span class="lineno"> 1345</span>    std::vector&lt;const Node *&gt; common_nodes;</div>
<div class="line"><span class="lineno"> 1346</span>    std::set_intersection(edge_nodes[0].begin(),</div>
<div class="line"><span class="lineno"> 1347</span>                          edge_nodes[0].end(),</div>
<div class="line"><span class="lineno"> 1348</span>                          edge_nodes[1].begin(),</div>
<div class="line"><span class="lineno"> 1349</span>                          edge_nodes[1].end(),</div>
<div class="line"><span class="lineno"> 1350</span>                          std::inserter(common_nodes, common_nodes.end()));</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">if</span> (common_nodes.size() != 1)</div>
<div class="line"><span class="lineno"> 1353</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid number of common nodes&quot;</span>);</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pinfo : edge_face_info)</div>
<div class="line"><span class="lineno"> 1356</span>      elems_to_exclude.insert(pinfo-&gt;_elem-&gt;id());</div>
<div class="line"><span class="lineno"> 1357</span> </div>
<div class="line"><span class="lineno"> 1358</span>    std::vector&lt;PenetrationInfo *&gt; face_info_comm_edge;</div>
<div class="line"><span class="lineno"> 1359</span>    <a class="code hl_function" href="classPenetrationThread.html#aca3bc5ded9e8d66365af79bea2399617">getInfoForFacesWithCommonNodes</a>(</div>
<div class="line"><span class="lineno"> 1360</span>        &amp;secondary_node, elems_to_exclude, common_nodes, face_info_comm_edge, p_info);</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_corner_neighbors = face_info_comm_edge.size();</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>    <span class="keywordflow">if</span> (num_corner_neighbors &gt; 0)</div>
<div class="line"><span class="lineno"> 1365</span>    {</div>
<div class="line"><span class="lineno"> 1366</span>      Real fw0 = edge_face_weights[0];</div>
<div class="line"><span class="lineno"> 1367</span>      Real fw1 = edge_face_weights[1];</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>      <span class="comment">// Corner weight is product of edge weights.  Spread out over multiple neighbors.</span></div>
<div class="line"><span class="lineno"> 1370</span>      Real fw_corner = (fw0 * fw1) / <span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(num_corner_neighbors);</div>
<div class="line"><span class="lineno"> 1371</span> </div>
<div class="line"><span class="lineno"> 1372</span>      <span class="comment">// Adjust original edge weights</span></div>
<div class="line"><span class="lineno"> 1373</span>      edge_face_weights[0] *= (1.0 - fw1);</div>
<div class="line"><span class="lineno"> 1374</span>      edge_face_weights[1] *= (1.0 - fw0);</div>
<div class="line"><span class="lineno"> 1375</span> </div>
<div class="line"><span class="lineno"> 1376</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; num_corner_neighbors; ++i)</div>
<div class="line"><span class="lineno"> 1377</span>      {</div>
<div class="line"><span class="lineno"> 1378</span>        edge_face_weights.push_back(fw_corner);</div>
<div class="line"><span class="lineno"> 1379</span>        edge_face_info.push_back(face_info_comm_edge[i]);</div>
<div class="line"><span class="lineno"> 1380</span>      }</div>
<div class="line"><span class="lineno"> 1381</span>    }</div>
<div class="line"><span class="lineno"> 1382</span>  }</div>
<div class="line"><span class="lineno"> 1383</span>}</div>
<div class="ttc" id="aclassPenetrationThread_html_a95093c8e61d812efc78503a056115fe9"><div class="ttname"><a href="classPenetrationThread.html#a95093c8e61d812efc78503a056115fe9">PenetrationThread::getSmoothingEdgeNodesAndWeights</a></div><div class="ttdeci">void getSmoothingEdgeNodesAndWeights(const Point &amp;p, const Elem *side, std::vector&lt; std::vector&lt; const Node * &gt; &gt; &amp;edge_nodes, std::vector&lt; Real &gt; &amp;edge_face_weights)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01386">PenetrationThread.C:1386</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_aca3bc5ded9e8d66365af79bea2399617"><div class="ttname"><a href="classPenetrationThread.html#aca3bc5ded9e8d66365af79bea2399617">PenetrationThread::getInfoForFacesWithCommonNodes</a></div><div class="ttdeci">void getInfoForFacesWithCommonNodes(const Node *secondary_node, const std::set&lt; dof_id_type &gt; &amp;elems_to_exclude, const std::vector&lt; const Node * &gt; edge_nodes, std::vector&lt; PenetrationInfo * &gt; &amp;face_info_comm_edge, std::vector&lt; PenetrationInfo * &gt; &amp;p_info)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01527">PenetrationThread.C:1527</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="a9701265e89432ca9f5692952af8b068a" name="a9701265e89432ca9f5692952af8b068a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9701265e89432ca9f5692952af8b068a">&#9670;&#160;</a></span>interactionsOffCommonEdge()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">PenetrationThread::CommonEdgeResult</a> PenetrationThread::interactionsOffCommonEdge </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>pi2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00597">597</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  598</span>{</div>
<div class="line"><span class="lineno">  599</span>  <a class="code hl_enumeration" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064f">CommonEdgeResult</a> common_edge(<a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064faf621651e398012481e6c2335cf94de29">NO_COMMON</a>);</div>
<div class="line"><span class="lineno">  600</span>  <span class="keyword">const</span> std::vector&lt;const Node *&gt; &amp; off_edge_nodes1 = pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>;</div>
<div class="line"><span class="lineno">  601</span>  <span class="keyword">const</span> std::vector&lt;const Node *&gt; &amp; off_edge_nodes2 = pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>;</div>
<div class="line"><span class="lineno">  602</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> dim1 = pi1-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim();</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <span class="keywordflow">if</span> (dim1 == 1)</div>
<div class="line"><span class="lineno">  605</span>  {</div>
<div class="line"><span class="lineno">  606</span>    mooseAssert(pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim() == 1, <span class="stringliteral">&quot;Incompatible dimensions.&quot;</span>);</div>
<div class="line"><span class="lineno">  607</span>    mooseAssert(off_edge_nodes1.size() &lt; 2 &amp;&amp; off_edge_nodes2.size() &lt; 2,</div>
<div class="line"><span class="lineno">  608</span>                <span class="stringliteral">&quot;off_edge_nodes size should be &lt;2 for 2D contact&quot;</span>);</div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">if</span> (off_edge_nodes1.size() == 1 &amp;&amp; off_edge_nodes2.size() == 1 &amp;&amp;</div>
<div class="line"><span class="lineno">  610</span>        off_edge_nodes1[0] == off_edge_nodes2[0])</div>
<div class="line"><span class="lineno">  611</span>      common_edge = <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">COMMON_EDGE</a>;</div>
<div class="line"><span class="lineno">  612</span>  }</div>
<div class="line"><span class="lineno">  613</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  614</span>  {</div>
<div class="line"><span class="lineno">  615</span>    mooseAssert(dim1 == 2 &amp;&amp; pi2-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim() == 2, <span class="stringliteral">&quot;Incompatible dimensions.&quot;</span>);</div>
<div class="line"><span class="lineno">  616</span>    mooseAssert(off_edge_nodes1.size() &lt; 3 &amp;&amp; off_edge_nodes2.size() &lt; 3,</div>
<div class="line"><span class="lineno">  617</span>                <span class="stringliteral">&quot;off_edge_nodes size should be &lt;3 for 3D contact&quot;</span>);</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">if</span> (off_edge_nodes1.size() == 1)</div>
<div class="line"><span class="lineno">  619</span>    {</div>
<div class="line"><span class="lineno">  620</span>      <span class="keywordflow">if</span> (off_edge_nodes2.size() == 1)</div>
<div class="line"><span class="lineno">  621</span>      {</div>
<div class="line"><span class="lineno">  622</span>        <span class="keywordflow">if</span> (off_edge_nodes1[0] == off_edge_nodes2[0])</div>
<div class="line"><span class="lineno">  623</span>          common_edge = <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa276448c015b9e5a75e4181c3244d112a">COMMON_NODE</a>;</div>
<div class="line"><span class="lineno">  624</span>      }</div>
<div class="line"><span class="lineno">  625</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (off_edge_nodes2.size() == 2)</div>
<div class="line"><span class="lineno">  626</span>      {</div>
<div class="line"><span class="lineno">  627</span>        <span class="keywordflow">if</span> (off_edge_nodes1[0] == off_edge_nodes2[0] || off_edge_nodes1[0] == off_edge_nodes2[1])</div>
<div class="line"><span class="lineno">  628</span>          common_edge = <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">EDGE_AND_COMMON_NODE</a>;</div>
<div class="line"><span class="lineno">  629</span>      }</div>
<div class="line"><span class="lineno">  630</span>    }</div>
<div class="line"><span class="lineno">  631</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (off_edge_nodes1.size() == 2)</div>
<div class="line"><span class="lineno">  632</span>    {</div>
<div class="line"><span class="lineno">  633</span>      <span class="keywordflow">if</span> (off_edge_nodes2.size() == 1)</div>
<div class="line"><span class="lineno">  634</span>      {</div>
<div class="line"><span class="lineno">  635</span>        <span class="keywordflow">if</span> (off_edge_nodes1[0] == off_edge_nodes2[0] || off_edge_nodes1[1] == off_edge_nodes2[0])</div>
<div class="line"><span class="lineno">  636</span>          common_edge = <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fafd4c45dbe48e5263b1949e66ed5cc658">EDGE_AND_COMMON_NODE</a>;</div>
<div class="line"><span class="lineno">  637</span>      }</div>
<div class="line"><span class="lineno">  638</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (off_edge_nodes2.size() == 2)</div>
<div class="line"><span class="lineno">  639</span>      {</div>
<div class="line"><span class="lineno">  640</span>        <span class="keywordflow">if</span> ((off_edge_nodes1[0] == off_edge_nodes2[0] &amp;&amp;</div>
<div class="line"><span class="lineno">  641</span>             off_edge_nodes1[1] == off_edge_nodes2[1]) ||</div>
<div class="line"><span class="lineno">  642</span>            (off_edge_nodes1[1] == off_edge_nodes2[0] &amp;&amp; off_edge_nodes1[0] == off_edge_nodes2[1]))</div>
<div class="line"><span class="lineno">  643</span>          common_edge = <a class="code hl_enumvalue" href="classPenetrationThread.html#abbdfcaf4eef16f85971bf60a7819064fa67d254b2b8d9c56191b28361edffb2f0">COMMON_EDGE</a>;</div>
<div class="line"><span class="lineno">  644</span>      }</div>
<div class="line"><span class="lineno">  645</span>    }</div>
<div class="line"><span class="lineno">  646</span>  }</div>
<div class="line"><span class="lineno">  647</span>  <span class="keywordflow">return</span> common_edge;</div>
<div class="line"><span class="lineno">  648</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00505">competeInteractions()</a>.</p>

</div>
</div>
<a id="adee847f1d95b90693e8ce87e62aaba69" name="adee847f1d95b90693e8ce87e62aaba69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adee847f1d95b90693e8ce87e62aaba69">&#9670;&#160;</a></span>isFaceReasonableCandidate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::isFaceReasonableCandidate </td>
          <td>(</td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>primary_elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FEBase *&#160;</td>
          <td class="paramname"><em>fe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Point *&#160;</td>
          <td class="paramname"><em>secondary_point</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Real&#160;</td>
          <td class="paramname"><em>tangential_tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01148">1148</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1153</span>{</div>
<div class="line"><span class="lineno"> 1154</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim = primary_elem-&gt;dim();</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>  <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; phys_point = fe-&gt;get_xyz();</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>  <span class="keyword">const</span> std::vector&lt;RealGradient&gt; &amp; dxyz_dxi = fe-&gt;get_dxyzdxi();</div>
<div class="line"><span class="lineno"> 1159</span>  <span class="keyword">const</span> std::vector&lt;RealGradient&gt; &amp; dxyz_deta = fe-&gt;get_dxyzdeta();</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>  Point ref_point;</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>  std::vector&lt;Point&gt; points(1); <span class="comment">// Default constructor gives us a point at 0,0,0</span></div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  fe-&gt;reinit(side, &amp;points);</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>  RealGradient d = *secondary_point - phys_point[0];</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keyword">const</span> Real twosqrt2 = 2.8284; <span class="comment">// way more precision than we actually need here</span></div>
<div class="line"><span class="lineno"> 1170</span>  Real max_face_length = side-&gt;hmax() + twosqrt2 * tangential_tolerance;</div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>  <a class="code hl_typedef" href="namespacelibMesh.html#a7b24a45345db9b61375489cb2d385538">RealVectorValue</a> normal;</div>
<div class="line"><span class="lineno"> 1173</span>  <span class="keywordflow">if</span> (dim - 1 == 2)</div>
<div class="line"><span class="lineno"> 1174</span>  {</div>
<div class="line"><span class="lineno"> 1175</span>    normal = dxyz_dxi[0].cross(dxyz_deta[0]);</div>
<div class="line"><span class="lineno"> 1176</span>  }</div>
<div class="line"><span class="lineno"> 1177</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dim - 1 == 1)</div>
<div class="line"><span class="lineno"> 1178</span>  {</div>
<div class="line"><span class="lineno"> 1179</span>    <span class="keyword">const</span> Node * <span class="keyword">const</span> * elem_nodes = primary_elem-&gt;get_nodes();</div>
<div class="line"><span class="lineno"> 1180</span>    <span class="keyword">const</span> Point in_plane_vector1 = *elem_nodes[1] - *elem_nodes[0];</div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keyword">const</span> Point in_plane_vector2 = *elem_nodes[2] - *elem_nodes[0];</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    Point out_of_plane_normal = in_plane_vector1.cross(in_plane_vector2);</div>
<div class="line"><span class="lineno"> 1184</span>    out_of_plane_normal /= out_of_plane_normal.norm();</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>    normal = dxyz_dxi[0].cross(out_of_plane_normal);</div>
<div class="line"><span class="lineno"> 1187</span>  }</div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1189</span>  {</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1191</span>  }</div>
<div class="line"><span class="lineno"> 1192</span>  normal /= normal.norm();</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>  <span class="keyword">const</span> Real dot(d * normal);</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>  <span class="keyword">const</span> RealGradient normcomp = dot * normal;</div>
<div class="line"><span class="lineno"> 1197</span>  <span class="keyword">const</span> RealGradient tangcomp = d - normcomp;</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>  <span class="keyword">const</span> Real tangdist = tangcomp.norm();</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>  <span class="comment">// Increase the size of the zone that we consider if the vector from the face</span></div>
<div class="line"><span class="lineno"> 1202</span>  <span class="comment">// to the node has a larger normal component</span></div>
<div class="line"><span class="lineno"> 1203</span>  <span class="keyword">const</span> Real faceExpansionFactor = 2.0 * (1.0 + normcomp.norm() / d.norm());</div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span>  <span class="keywordtype">bool</span> isReasonableCandidate = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1206</span>  <span class="keywordflow">if</span> (tangdist &gt; faceExpansionFactor * max_face_length)</div>
<div class="line"><span class="lineno"> 1207</span>  {</div>
<div class="line"><span class="lineno"> 1208</span>    isReasonableCandidate = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1209</span>  }</div>
<div class="line"><span class="lineno"> 1210</span>  <span class="keywordflow">return</span> isReasonableCandidate;</div>
<div class="line"><span class="lineno"> 1211</span>}</div>
<div class="ttc" id="anamespacelibMesh_html_a7b24a45345db9b61375489cb2d385538"><div class="ttname"><a href="namespacelibMesh.html#a7b24a45345db9b61375489cb2d385538">libMesh::RealVectorValue</a></div><div class="ttdeci">VectorValue&lt; Real &gt; RealVectorValue</div><div class="ttdef"><b>Definition:</b> <a href="Assembly_8h_source.html#l00038">Assembly.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>.</p>

</div>
</div>
<a id="ace197eadb3ba19016cca2c32cac6281a" name="ace197eadb3ba19016cca2c32cac6281a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace197eadb3ba19016cca2c32cac6281a">&#9670;&#160;</a></span>join()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::join </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classPenetrationThread.html">PenetrationThread</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00463">463</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  464</span>{</div>
<div class="line"><span class="lineno">  465</span>  <a class="code hl_variable" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a>.insert(<a class="code hl_variable" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a>.end(),</div>
<div class="line"><span class="lineno">  466</span>                                  other.<a class="code hl_variable" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a>.begin(),</div>
<div class="line"><span class="lineno">  467</span>                                  other.<a class="code hl_variable" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a>.end());</div>
<div class="line"><span class="lineno">  468</span>}</div>
<div class="ttc" id="aclassPenetrationThread_html_a5e6f815a9ef19c2835a0d017ba8201b5"><div class="ttname"><a href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">PenetrationThread::_recheck_secondary_nodes</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _recheck_secondary_nodes</div><div class="ttdoc">List of secondary nodes for which penetration was not detected in the current patch and for which pat...</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8h_source.html#l00053">PenetrationThread.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a44f25d7fe5c110cac3eb45a87e9a4c76" name="a44f25d7fe5c110cac3eb45a87e9a4c76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f25d7fe5c110cac3eb45a87e9a4c76">&#9670;&#160;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::operator() </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="MooseTypes_8h.html#ac1e1763891f78be5c11fde4d9c03effd">NodeIdRange</a> &amp;&#160;</td>
          <td class="paramname"><em>range</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00088">88</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>{</div>
<div class="line"><span class="lineno">   90</span>  <a class="code hl_class" href="classParallelUniqueId.html">ParallelUniqueId</a> puid;</div>
<div class="line"><span class="lineno">   91</span>  <a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a> = puid.<a class="code hl_variable" href="classParallelUniqueId.html#ab64d3c23ad4c6cca5ef885b5b5e520cd">id</a>;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// Must get the variables every time this is run because _tid can change</span></div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a> &amp;&amp;</div>
<div class="line"><span class="lineno">   95</span>      <a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a> == <a class="code hl_enumvalue" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418a69f3a4e1a73ee9b163de54e1bdc33710">PenetrationLocator::NSM_NODAL_NORMAL_BASED</a>)</div>
<div class="line"><span class="lineno">   96</span>  {</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_variable" href="classPenetrationThread.html#a155ca06846b2d2adf31c6a0d0f854ee5">_nodal_normal_x</a> = &amp;<a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>.<a class="code hl_function" href="classSubProblem.html#a4b526f62e5a78e17092aca0e12e97b1c">getStandardVariable</a>(<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>, <span class="stringliteral">&quot;nodal_normal_x&quot;</span>);</div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_variable" href="classPenetrationThread.html#a5f6b5d6b51acb18db71e2d97bc03f6b3">_nodal_normal_y</a> = &amp;<a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>.<a class="code hl_function" href="classSubProblem.html#a4b526f62e5a78e17092aca0e12e97b1c">getStandardVariable</a>(<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>, <span class="stringliteral">&quot;nodal_normal_y&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_variable" href="classPenetrationThread.html#a59b725e379e763363279e9526132b196">_nodal_normal_z</a> = &amp;<a class="code hl_variable" href="classPenetrationThread.html#af12aa39941322927db05b53db5015973">_subproblem</a>.<a class="code hl_function" href="classSubProblem.html#a4b526f62e5a78e17092aca0e12e97b1c">getStandardVariable</a>(<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>, <span class="stringliteral">&quot;nodal_normal_z&quot;</span>);</div>
<div class="line"><span class="lineno">  100</span>  }</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node_id : range)</div>
<div class="line"><span class="lineno">  103</span>  {</div>
<div class="line"><span class="lineno">  104</span>    <span class="keyword">const</span> Node &amp; node = <a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>.<a class="code hl_function" href="classMooseMesh.html#a12c8284113f61e6cdbe91dc0ca931ab4">nodeRef</a>(node_id);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <span class="comment">// We&#39;re going to get a reference to the pointer for the pinfo for this node</span></div>
<div class="line"><span class="lineno">  107</span>    <span class="comment">// This will allow us to manipulate this pointer without having to go through</span></div>
<div class="line"><span class="lineno">  108</span>    <span class="comment">// the _penetration_info map... meaning this is the only mutex we&#39;ll have to do!</span></div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_variable" href="PenetrationThread_8C.html#ac80a76b23342a7996513340481755b82">pinfo_mutex</a>.lock();</div>
<div class="line"><span class="lineno">  110</span>    <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a> *&amp; info = <a class="code hl_variable" href="classPenetrationThread.html#a13db996555fd7db080562a79a5ecac48">_penetration_info</a>[node.id()];</div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_variable" href="PenetrationThread_8C.html#ac80a76b23342a7996513340481755b82">pinfo_mutex</a>.unlock();</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>    std::vector&lt;PenetrationInfo *&gt; p_info;</div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordtype">bool</span> info_set(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="comment">// See if we already have info about this node</span></div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">if</span> (info)</div>
<div class="line"><span class="lineno">  118</span>    {</div>
<div class="line"><span class="lineno">  119</span>      <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_elem = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">_elem</a>-&gt;dim()];</div>
<div class="line"><span class="lineno">  120</span>      <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_side = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim()];</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPenetrationThread.html#a82ae4101cc5ecf1533d16822c24ef746">_update_location</a> &amp;&amp; (info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> &gt;= 0 || info-&gt;<a class="code hl_function" href="classPenetrationInfo.html#ab74f6822f49072c16b21c24e59020b0b">isCaptured</a>()))</div>
<div class="line"><span class="lineno">  123</span>      {</div>
<div class="line"><span class="lineno">  124</span>        <span class="keyword">const</span> Point contact_ref = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a>;</div>
<div class="line"><span class="lineno">  125</span>        <span class="keywordtype">bool</span> contact_point_on_side(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>        <span class="comment">// Secondary position must be the previous contact point</span></div>
<div class="line"><span class="lineno">  128</span>        <span class="comment">// Use the previous reference coordinates</span></div>
<div class="line"><span class="lineno">  129</span>        std::vector&lt;Point&gt; points(1);</div>
<div class="line"><span class="lineno">  130</span>        points[0] = contact_ref;</div>
<div class="line"><span class="lineno">  131</span>        <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; secondary_pos = fe_side-&gt;get_xyz();</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>        fe_side-&gt;reinit(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, &amp;points);</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="namespaceMoose.html#a89353d7afa7eb5922767ae545cd98b85">Moose::findContactPoint</a>(*info,</div>
<div class="line"><span class="lineno">  135</span>                                fe_elem,</div>
<div class="line"><span class="lineno">  136</span>                                fe_side,</div>
<div class="line"><span class="lineno">  137</span>                                <a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>,</div>
<div class="line"><span class="lineno">  138</span>                                secondary_pos[0],</div>
<div class="line"><span class="lineno">  139</span>                                <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  140</span>                                <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>,</div>
<div class="line"><span class="lineno">  141</span>                                contact_point_on_side);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>        <span class="comment">// Restore the original reference coordinates</span></div>
<div class="line"><span class="lineno">  144</span>        info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a> = contact_ref;</div>
<div class="line"><span class="lineno">  145</span>        <span class="comment">// Just calculated as the distance of the contact point off the surface (0).  Set to 0 to</span></div>
<div class="line"><span class="lineno">  146</span>        <span class="comment">// avoid round-off.</span></div>
<div class="line"><span class="lineno">  147</span>        info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac9e910ef0e1b0b8ffa04ab432257bc7a">_distance</a> = 0.0;</div>
<div class="line"><span class="lineno">  148</span>        info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  149</span>      }</div>
<div class="line"><span class="lineno">  150</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  151</span>      {</div>
<div class="line"><span class="lineno">  152</span>        Real old_tangential_distance(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a>);</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordtype">bool</span> contact_point_on_side(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>        <a class="code hl_function" href="namespaceMoose.html#a89353d7afa7eb5922767ae545cd98b85">Moose::findContactPoint</a>(*info,</div>
<div class="line"><span class="lineno">  156</span>                                fe_elem,</div>
<div class="line"><span class="lineno">  157</span>                                fe_side,</div>
<div class="line"><span class="lineno">  158</span>                                <a class="code hl_variable" href="classPenetrationThread.html#af1f236c5648c31a2f14b8c8e00cf4f9a">_fe_type</a>,</div>
<div class="line"><span class="lineno">  159</span>                                node,</div>
<div class="line"><span class="lineno">  160</span>                                <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  161</span>                                <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>,</div>
<div class="line"><span class="lineno">  162</span>                                contact_point_on_side);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> (contact_point_on_side)</div>
<div class="line"><span class="lineno">  165</span>        {</div>
<div class="line"><span class="lineno">  166</span>          <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &lt;= 0.0) <span class="comment">// on the face</span></div>
<div class="line"><span class="lineno">  167</span>          {</div>
<div class="line"><span class="lineno">  168</span>            info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  169</span>          }</div>
<div class="line"><span class="lineno">  170</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad8f5014719cb16ff7af2c6683b68a290">_tangential_distance</a> &gt; 0.0 &amp;&amp; old_tangential_distance &gt; 0.0)</div>
<div class="line"><span class="lineno">  171</span>          { <span class="comment">// off the face but within tolerance, was that way on the last step too</span></div>
<div class="line"><span class="lineno">  172</span>            <span class="keywordflow">if</span> (info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim() == 2 &amp;&amp; info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a047ec8801894440eb54cddb74e0783a4">_off_edge_nodes</a>.size() &lt; 2)</div>
<div class="line"><span class="lineno">  173</span>            { <span class="comment">// Closest point on face is on a node rather than an edge.  Another</span></div>
<div class="line"><span class="lineno">  174</span>              <span class="comment">// face might be a better candidate.</span></div>
<div class="line"><span class="lineno">  175</span>            }</div>
<div class="line"><span class="lineno">  176</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  177</span>            {</div>
<div class="line"><span class="lineno">  178</span>              info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  179</span>            }</div>
<div class="line"><span class="lineno">  180</span>          }</div>
<div class="line"><span class="lineno">  181</span>        }</div>
<div class="line"><span class="lineno">  182</span>      }</div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">if</span> (!info_set)</div>
<div class="line"><span class="lineno">  186</span>    {</div>
<div class="line"><span class="lineno">  187</span>      <span class="keyword">const</span> Node * closest_node = <a class="code hl_variable" href="classPenetrationThread.html#ad35dd91b4b0d3d7da352448f2db98261">_nearest_node</a>.<a class="code hl_function" href="classNearestNodeLocator.html#a3944f1d3b86ffac34b1275695fcfc285">nearestNode</a>(node.id());</div>
<div class="line"><span class="lineno">  188</span>      <span class="keyword">auto</span> node_to_elem_pair = <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>.find(closest_node-&gt;id());</div>
<div class="line"><span class="lineno">  189</span>      mooseAssert(node_to_elem_pair != <a class="code hl_variable" href="classPenetrationThread.html#ab5e53096048ca50930377df4b1d37354">_node_to_elem_map</a>.end(),</div>
<div class="line"><span class="lineno">  190</span>                  <span class="stringliteral">&quot;Missing entry in node to elem map&quot;</span>);</div>
<div class="line"><span class="lineno">  191</span>      <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; closest_elems = node_to_elem_pair-&gt;second;</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem_id : closest_elems)</div>
<div class="line"><span class="lineno">  194</span>      {</div>
<div class="line"><span class="lineno">  195</span>        <span class="keyword">const</span> Elem * elem = <a class="code hl_variable" href="classPenetrationThread.html#aa54eff71efe30dbc6a66c0a4f265fbde">_mesh</a>.<a class="code hl_function" href="classMooseMesh.html#a27dd2a8bcd30f81c67449911092cb8f0">elemPtr</a>(elem_id);</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>        std::vector&lt;PenetrationInfo *&gt; thisElemInfo;</div>
<div class="line"><span class="lineno">  198</span>        std::vector&lt;const Node *&gt; nodesThatMustBeOnSide;</div>
<div class="line"><span class="lineno">  199</span>        nodesThatMustBeOnSide.push_back(closest_node);</div>
<div class="line"><span class="lineno">  200</span>        <a class="code hl_function" href="classPenetrationThread.html#a0a5e021c838e9000723e640ebfb98b20">createInfoForElem</a>(</div>
<div class="line"><span class="lineno">  201</span>            thisElemInfo, p_info, &amp;node, elem, nodesThatMustBeOnSide, <a class="code hl_variable" href="classPenetrationThread.html#a288d215a74b64a28d24b1d140cd250ae">_check_whether_reasonable</a>);</div>
<div class="line"><span class="lineno">  202</span>      }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>      <span class="keywordflow">if</span> (p_info.size() == 1)</div>
<div class="line"><span class="lineno">  205</span>      {</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">if</span> (p_info[0]-&gt;_tangential_distance &lt;= <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>)</div>
<div class="line"><span class="lineno">  207</span>        {</div>
<div class="line"><span class="lineno">  208</span>          <a class="code hl_function" href="classPenetrationThread.html#a89f761e759cbcdd607aa3bfe0cce57a9">switchInfo</a>(info, p_info[0]);</div>
<div class="line"><span class="lineno">  209</span>          info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  210</span>        }</div>
<div class="line"><span class="lineno">  211</span>      }</div>
<div class="line"><span class="lineno">  212</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p_info.size() &gt; 1)</div>
<div class="line"><span class="lineno">  213</span>      {</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>        <span class="comment">// Loop through all pairs of faces, and check for contact on ridge betweeen each face pair</span></div>
<div class="line"><span class="lineno">  216</span>        std::vector&lt;RidgeData&gt; ridgeDataVec;</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i + 1 &lt; p_info.size(); ++i)</div>
<div class="line"><span class="lineno">  218</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = i + 1; j &lt; p_info.size(); ++j)</div>
<div class="line"><span class="lineno">  219</span>          {</div>
<div class="line"><span class="lineno">  220</span>            Point closest_coor;</div>
<div class="line"><span class="lineno">  221</span>            Real tangential_distance(0.0);</div>
<div class="line"><span class="lineno">  222</span>            <span class="keyword">const</span> Node * closest_node_on_ridge = NULL;</div>
<div class="line"><span class="lineno">  223</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><span class="lineno">  224</span>            Point closest_coor_ref;</div>
<div class="line"><span class="lineno">  225</span>            <span class="keywordtype">bool</span> found_ridge_contact_point = <a class="code hl_function" href="classPenetrationThread.html#afed2aedb63399dd31f62684d459c6494">findRidgeContactPoint</a>(closest_coor,</div>
<div class="line"><span class="lineno">  226</span>                                                                   tangential_distance,</div>
<div class="line"><span class="lineno">  227</span>                                                                   closest_node_on_ridge,</div>
<div class="line"><span class="lineno">  228</span>                                                                   index,</div>
<div class="line"><span class="lineno">  229</span>                                                                   closest_coor_ref,</div>
<div class="line"><span class="lineno">  230</span>                                                                   p_info,</div>
<div class="line"><span class="lineno">  231</span>                                                                   i,</div>
<div class="line"><span class="lineno">  232</span>                                                                   j);</div>
<div class="line"><span class="lineno">  233</span>            <span class="keywordflow">if</span> (found_ridge_contact_point)</div>
<div class="line"><span class="lineno">  234</span>            {</div>
<div class="line"><span class="lineno">  235</span>              RidgeData rpd;</div>
<div class="line"><span class="lineno">  236</span>              rpd._closest_coor = closest_coor;</div>
<div class="line"><span class="lineno">  237</span>              rpd._tangential_distance = tangential_distance;</div>
<div class="line"><span class="lineno">  238</span>              rpd._closest_node = closest_node_on_ridge;</div>
<div class="line"><span class="lineno">  239</span>              rpd._index = index;</div>
<div class="line"><span class="lineno">  240</span>              rpd._closest_coor_ref = closest_coor_ref;</div>
<div class="line"><span class="lineno">  241</span>              ridgeDataVec.push_back(rpd);</div>
<div class="line"><span class="lineno">  242</span>            }</div>
<div class="line"><span class="lineno">  243</span>          }</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordflow">if</span> (ridgeDataVec.size() &gt; 0) <span class="comment">// Either find the ridge pair that is the best or find a peak</span></div>
<div class="line"><span class="lineno">  246</span>        {</div>
<div class="line"><span class="lineno">  247</span>          <span class="comment">// Group together ridges for which we are off the edge of a common node.</span></div>
<div class="line"><span class="lineno">  248</span>          <span class="comment">// Those are peaks.</span></div>
<div class="line"><span class="lineno">  249</span>          std::vector&lt;RidgeSetData&gt; ridgeSetDataVec;</div>
<div class="line"><span class="lineno">  250</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ridgeDataVec.size(); ++i)</div>
<div class="line"><span class="lineno">  251</span>          {</div>
<div class="line"><span class="lineno">  252</span>            <span class="keywordtype">bool</span> foundSetWithMatchingNode = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  253</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; ridgeSetDataVec.size(); ++j)</div>
<div class="line"><span class="lineno">  254</span>            {</div>
<div class="line"><span class="lineno">  255</span>              <span class="keywordflow">if</span> (ridgeDataVec[i]._closest_node != NULL &amp;&amp;</div>
<div class="line"><span class="lineno">  256</span>                  ridgeDataVec[i]._closest_node == ridgeSetDataVec[j]._closest_node)</div>
<div class="line"><span class="lineno">  257</span>              {</div>
<div class="line"><span class="lineno">  258</span>                foundSetWithMatchingNode = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  259</span>                ridgeSetDataVec[j]._ridge_data_vec.push_back(ridgeDataVec[i]);</div>
<div class="line"><span class="lineno">  260</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  261</span>              }</div>
<div class="line"><span class="lineno">  262</span>            }</div>
<div class="line"><span class="lineno">  263</span>            <span class="keywordflow">if</span> (!foundSetWithMatchingNode)</div>
<div class="line"><span class="lineno">  264</span>            {</div>
<div class="line"><span class="lineno">  265</span>              RidgeSetData rsd;</div>
<div class="line"><span class="lineno">  266</span>              rsd._distance = std::numeric_limits&lt;Real&gt;::max();</div>
<div class="line"><span class="lineno">  267</span>              rsd._ridge_data_vec.push_back(ridgeDataVec[i]);</div>
<div class="line"><span class="lineno">  268</span>              rsd._closest_node = ridgeDataVec[i]._closest_node;</div>
<div class="line"><span class="lineno">  269</span>              ridgeSetDataVec.push_back(rsd);</div>
<div class="line"><span class="lineno">  270</span>            }</div>
<div class="line"><span class="lineno">  271</span>          }</div>
<div class="line"><span class="lineno">  272</span>          <span class="comment">// Compute distance to each set of ridges</span></div>
<div class="line"><span class="lineno">  273</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; ridgeSetDataVec.size(); ++i)</div>
<div class="line"><span class="lineno">  274</span>          {</div>
<div class="line"><span class="lineno">  275</span>            <span class="keywordflow">if</span> (ridgeSetDataVec[i]._closest_node !=</div>
<div class="line"><span class="lineno">  276</span>                NULL) <span class="comment">// Either a peak or off the edge of single ridge</span></div>
<div class="line"><span class="lineno">  277</span>            {</div>
<div class="line"><span class="lineno">  278</span>              <span class="keywordflow">if</span> (ridgeSetDataVec[i]._ridge_data_vec.size() == 1) <span class="comment">// off edge of single ridge</span></div>
<div class="line"><span class="lineno">  279</span>              {</div>
<div class="line"><span class="lineno">  280</span>                <span class="keywordflow">if</span> (ridgeSetDataVec[i]._ridge_data_vec[0]._tangential_distance &lt;=</div>
<div class="line"><span class="lineno">  281</span>                    <a class="code hl_variable" href="classPenetrationThread.html#a7175fbcdc90c32d942dad42ad93d5474">_tangential_tolerance</a>) <span class="comment">// off within tolerance</span></div>
<div class="line"><span class="lineno">  282</span>                {</div>
<div class="line"><span class="lineno">  283</span>                  ridgeSetDataVec[i]._closest_coor =</div>
<div class="line"><span class="lineno">  284</span>                      ridgeSetDataVec[i]._ridge_data_vec[0]._closest_coor;</div>
<div class="line"><span class="lineno">  285</span>                  Point contact_point_vec = node - ridgeSetDataVec[i]._closest_coor;</div>
<div class="line"><span class="lineno">  286</span>                  ridgeSetDataVec[i]._distance = contact_point_vec.norm();</div>
<div class="line"><span class="lineno">  287</span>                }</div>
<div class="line"><span class="lineno">  288</span>              }</div>
<div class="line"><span class="lineno">  289</span>              <span class="keywordflow">else</span> <span class="comment">// several ridges join at common node to make peak.  The common node is the</span></div>
<div class="line"><span class="lineno">  290</span>                   <span class="comment">// contact point</span></div>
<div class="line"><span class="lineno">  291</span>              {</div>
<div class="line"><span class="lineno">  292</span>                ridgeSetDataVec[i]._closest_coor = *ridgeSetDataVec[i]._closest_node;</div>
<div class="line"><span class="lineno">  293</span>                Point contact_point_vec = node - ridgeSetDataVec[i]._closest_coor;</div>
<div class="line"><span class="lineno">  294</span>                ridgeSetDataVec[i]._distance = contact_point_vec.norm();</div>
<div class="line"><span class="lineno">  295</span>              }</div>
<div class="line"><span class="lineno">  296</span>            }</div>
<div class="line"><span class="lineno">  297</span>            <span class="keywordflow">else</span> <span class="comment">// on a single ridge</span></div>
<div class="line"><span class="lineno">  298</span>            {</div>
<div class="line"><span class="lineno">  299</span>              ridgeSetDataVec[i]._closest_coor =</div>
<div class="line"><span class="lineno">  300</span>                  ridgeSetDataVec[i]._ridge_data_vec[0]._closest_coor;</div>
<div class="line"><span class="lineno">  301</span>              Point contact_point_vec = node - ridgeSetDataVec[i]._closest_coor;</div>
<div class="line"><span class="lineno">  302</span>              ridgeSetDataVec[i]._distance = contact_point_vec.norm();</div>
<div class="line"><span class="lineno">  303</span>            }</div>
<div class="line"><span class="lineno">  304</span>          }</div>
<div class="line"><span class="lineno">  305</span>          <span class="comment">// Find the set of ridges closest to us.</span></div>
<div class="line"><span class="lineno">  306</span>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> closest_ridge_set_index(0);</div>
<div class="line"><span class="lineno">  307</span>          Real closest_distance(ridgeSetDataVec[0]._distance);</div>
<div class="line"><span class="lineno">  308</span>          Point closest_point(ridgeSetDataVec[0]._closest_coor);</div>
<div class="line"><span class="lineno">  309</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 1; i &lt; ridgeSetDataVec.size(); ++i)</div>
<div class="line"><span class="lineno">  310</span>          {</div>
<div class="line"><span class="lineno">  311</span>            <span class="keywordflow">if</span> (ridgeSetDataVec[i]._distance &lt; closest_distance)</div>
<div class="line"><span class="lineno">  312</span>            {</div>
<div class="line"><span class="lineno">  313</span>              closest_ridge_set_index = i;</div>
<div class="line"><span class="lineno">  314</span>              closest_distance = ridgeSetDataVec[i]._distance;</div>
<div class="line"><span class="lineno">  315</span>              closest_point = ridgeSetDataVec[i]._closest_coor;</div>
<div class="line"><span class="lineno">  316</span>            }</div>
<div class="line"><span class="lineno">  317</span>          }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>          <span class="keywordflow">if</span> (closest_distance &lt;</div>
<div class="line"><span class="lineno">  320</span>              std::numeric_limits&lt;Real&gt;::max()) <span class="comment">// contact point is on the closest ridge set</span></div>
<div class="line"><span class="lineno">  321</span>          {</div>
<div class="line"><span class="lineno">  322</span>            <span class="comment">// find the face in the ridge set with the smallest index, assign that one to the</span></div>
<div class="line"><span class="lineno">  323</span>            <span class="comment">// interaction</span></div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face_index(std::numeric_limits&lt;unsigned int&gt;::max());</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><span class="lineno">  326</span>                 i &lt; ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec.size();</div>
<div class="line"><span class="lineno">  327</span>                 ++i)</div>
<div class="line"><span class="lineno">  328</span>            {</div>
<div class="line"><span class="lineno">  329</span>              <span class="keywordflow">if</span> (ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec[i]._index &lt; face_index)</div>
<div class="line"><span class="lineno">  330</span>                face_index = ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec[i]._index;</div>
<div class="line"><span class="lineno">  331</span>            }</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>            mooseAssert(face_index &lt; std::numeric_limits&lt;unsigned int&gt;::max(),</div>
<div class="line"><span class="lineno">  334</span>                        <span class="stringliteral">&quot;face_index invalid&quot;</span>);</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>            p_info[face_index]-&gt;_closest_point = closest_point;</div>
<div class="line"><span class="lineno">  337</span>            p_info[face_index]-&gt;_distance =</div>
<div class="line"><span class="lineno">  338</span>                (p_info[face_index]-&gt;_distance &gt;= 0.0 ? 1.0 : -1.0) * closest_distance;</div>
<div class="line"><span class="lineno">  339</span>            <span class="comment">// Calculate the normal as the vector from the ridge to the point only if we&#39;re not</span></div>
<div class="line"><span class="lineno">  340</span>            <span class="comment">// doing normal</span></div>
<div class="line"><span class="lineno">  341</span>            <span class="comment">// smoothing.  Normal smoothing will average out the normals on its own.</span></div>
<div class="line"><span class="lineno">  342</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a>)</div>
<div class="line"><span class="lineno">  343</span>            {</div>
<div class="line"><span class="lineno">  344</span>              Point normal(closest_point - node);</div>
<div class="line"><span class="lineno">  345</span>              <span class="keyword">const</span> Real len(normal.norm());</div>
<div class="line"><span class="lineno">  346</span>              <span class="keywordflow">if</span> (len &gt; 0)</div>
<div class="line"><span class="lineno">  347</span>              {</div>
<div class="line"><span class="lineno">  348</span>                normal /= len;</div>
<div class="line"><span class="lineno">  349</span>              }</div>
<div class="line"><span class="lineno">  350</span>              <span class="keyword">const</span> Real dot(normal * p_info[face_index]-&gt;_normal);</div>
<div class="line"><span class="lineno">  351</span>              <span class="keywordflow">if</span> (dot &lt; 0)</div>
<div class="line"><span class="lineno">  352</span>              {</div>
<div class="line"><span class="lineno">  353</span>                normal *= -1;</div>
<div class="line"><span class="lineno">  354</span>              }</div>
<div class="line"><span class="lineno">  355</span>              p_info[face_index]-&gt;_normal = normal;</div>
<div class="line"><span class="lineno">  356</span>            }</div>
<div class="line"><span class="lineno">  357</span>            p_info[face_index]-&gt;_tangential_distance = 0.0;</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>            Point closest_point_ref;</div>
<div class="line"><span class="lineno">  360</span>            <span class="keywordflow">if</span> (ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec.size() ==</div>
<div class="line"><span class="lineno">  361</span>                1) <span class="comment">// contact with a single ridge rather than a peak</span></div>
<div class="line"><span class="lineno">  362</span>            {</div>
<div class="line"><span class="lineno">  363</span>              p_info[face_index]-&gt;_tangential_distance =</div>
<div class="line"><span class="lineno">  364</span>                  ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec[0]._tangential_distance;</div>
<div class="line"><span class="lineno">  365</span>              p_info[face_index]-&gt;_closest_point_ref =</div>
<div class="line"><span class="lineno">  366</span>                  ridgeSetDataVec[closest_ridge_set_index]._ridge_data_vec[0]._closest_coor_ref;</div>
<div class="line"><span class="lineno">  367</span>            }</div>
<div class="line"><span class="lineno">  368</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  369</span>            { <span class="comment">// peak</span></div>
<div class="line"><span class="lineno">  370</span>              <span class="keyword">const</span> Node * closest_node_on_face;</div>
<div class="line"><span class="lineno">  371</span>              <span class="keywordtype">bool</span> restricted = <a class="code hl_function" href="classPenetrationThread.html#acd8671738159f333a5f235a17ca15bd6">restrictPointToFace</a>(p_info[face_index]-&gt;_closest_point_ref,</div>
<div class="line"><span class="lineno">  372</span>                                                    closest_node_on_face,</div>
<div class="line"><span class="lineno">  373</span>                                                    p_info[face_index]-&gt;_side);</div>
<div class="line"><span class="lineno">  374</span>              <span class="keywordflow">if</span> (restricted)</div>
<div class="line"><span class="lineno">  375</span>              {</div>
<div class="line"><span class="lineno">  376</span>                <span class="keywordflow">if</span> (closest_node_on_face != ridgeSetDataVec[closest_ridge_set_index]._closest_node)</div>
<div class="line"><span class="lineno">  377</span>                {</div>
<div class="line"><span class="lineno">  378</span>                  <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Closest node when restricting point to face != closest node from &quot;</span></div>
<div class="line"><span class="lineno">  379</span>                             <span class="stringliteral">&quot;RidgeSetData&quot;</span>);</div>
<div class="line"><span class="lineno">  380</span>                }</div>
<div class="line"><span class="lineno">  381</span>              }</div>
<div class="line"><span class="lineno">  382</span>            }</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>            <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][p_info[face_index]-&gt;_side-&gt;dim()];</div>
<div class="line"><span class="lineno">  385</span>            std::vector&lt;Point&gt; points(1);</div>
<div class="line"><span class="lineno">  386</span>            points[0] = p_info[face_index]-&gt;_closest_point_ref;</div>
<div class="line"><span class="lineno">  387</span>            fe-&gt;reinit(p_info[face_index]-&gt;_side, &amp;points);</div>
<div class="line"><span class="lineno">  388</span>            p_info[face_index]-&gt;_side_phi = fe-&gt;get_phi();</div>
<div class="line"><span class="lineno">  389</span>            p_info[face_index]-&gt;_side_grad_phi = fe-&gt;get_dphi();</div>
<div class="line"><span class="lineno">  390</span>            p_info[face_index]-&gt;_dxyzdxi = fe-&gt;get_dxyzdxi();</div>
<div class="line"><span class="lineno">  391</span>            p_info[face_index]-&gt;_dxyzdeta = fe-&gt;get_dxyzdeta();</div>
<div class="line"><span class="lineno">  392</span>            p_info[face_index]-&gt;_d2xyzdxideta = fe-&gt;get_d2xyzdxideta();</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>            <a class="code hl_function" href="classPenetrationThread.html#a89f761e759cbcdd607aa3bfe0cce57a9">switchInfo</a>(info, p_info[face_index]);</div>
<div class="line"><span class="lineno">  395</span>            info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  396</span>          }</div>
<div class="line"><span class="lineno">  397</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  398</span>          { <span class="comment">// todo:remove invalid ridge cases so they don&#39;t mess up individual face competition????</span></div>
<div class="line"><span class="lineno">  399</span>          }</div>
<div class="line"><span class="lineno">  400</span>        }</div>
<div class="line"><span class="lineno">  401</span> </div>
<div class="line"><span class="lineno">  402</span>        <span class="keywordflow">if</span> (!info_set) <span class="comment">// contact wasn&#39;t on a ridge -- compete individual interactions</span></div>
<div class="line"><span class="lineno">  403</span>        {</div>
<div class="line"><span class="lineno">  404</span>          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> best(0), i(1);</div>
<div class="line"><span class="lineno">  405</span>          <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  406</span>          {</div>
<div class="line"><span class="lineno">  407</span>            <a class="code hl_enumeration" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206">CompeteInteractionResult</a> CIResult = <a class="code hl_function" href="classPenetrationThread.html#afce58305a7fce32380a8d3061ca114a3">competeInteractions</a>(p_info[best], p_info[i]);</div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">if</span> (CIResult == <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a7d14ce88790ca9dec9d3192ceda6dfe1">FIRST_WINS</a>)</div>
<div class="line"><span class="lineno">  409</span>            {</div>
<div class="line"><span class="lineno">  410</span>              i++;</div>
<div class="line"><span class="lineno">  411</span>            }</div>
<div class="line"><span class="lineno">  412</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CIResult == <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206aea630e09c0ff61f8f4ed1de29ab06aca">SECOND_WINS</a>)</div>
<div class="line"><span class="lineno">  413</span>            {</div>
<div class="line"><span class="lineno">  414</span>              best = i;</div>
<div class="line"><span class="lineno">  415</span>              i++;</div>
<div class="line"><span class="lineno">  416</span>            }</div>
<div class="line"><span class="lineno">  417</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CIResult == <a class="code hl_enumvalue" href="classPenetrationThread.html#ac798f14b005d69d51f3075930607d206a58d8a4ff29d269a92fbd7197be2c42b6">NEITHER_WINS</a>)</div>
<div class="line"><span class="lineno">  418</span>            {</div>
<div class="line"><span class="lineno">  419</span>              best = i + 1;</div>
<div class="line"><span class="lineno">  420</span>              i += 2;</div>
<div class="line"><span class="lineno">  421</span>            }</div>
<div class="line"><span class="lineno">  422</span>          } <span class="keywordflow">while</span> (i &lt; p_info.size() &amp;&amp; best &lt; p_info.size());</div>
<div class="line"><span class="lineno">  423</span>          <span class="keywordflow">if</span> (best &lt; p_info.size())</div>
<div class="line"><span class="lineno">  424</span>          {</div>
<div class="line"><span class="lineno">  425</span>            <a class="code hl_function" href="classPenetrationThread.html#a89f761e759cbcdd607aa3bfe0cce57a9">switchInfo</a>(info, p_info[best]);</div>
<div class="line"><span class="lineno">  426</span>            info_set = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  427</span>          }</div>
<div class="line"><span class="lineno">  428</span>        }</div>
<div class="line"><span class="lineno">  429</span>      }</div>
<div class="line"><span class="lineno">  430</span>    }</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">if</span> (!info_set)</div>
<div class="line"><span class="lineno">  433</span>    {</div>
<div class="line"><span class="lineno">  434</span>      <span class="comment">// If penetration is not detected within the saved patch, it is possible</span></div>
<div class="line"><span class="lineno">  435</span>      <span class="comment">// that the secondary node has moved outside the saved patch. So, the patch</span></div>
<div class="line"><span class="lineno">  436</span>      <span class="comment">// for the secondary nodes saved in _recheck_secondary_nodes has to be updated</span></div>
<div class="line"><span class="lineno">  437</span>      <span class="comment">// and the penetration detection has to be re-run on the updated patch.</span></div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>      <a class="code hl_variable" href="classPenetrationThread.html#a5e6f815a9ef19c2835a0d017ba8201b5">_recheck_secondary_nodes</a>.push_back(node_id);</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>      <span class="keyword">delete</span> info;</div>
<div class="line"><span class="lineno">  442</span>      info = NULL;</div>
<div class="line"><span class="lineno">  443</span>    }</div>
<div class="line"><span class="lineno">  444</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  445</span>    {</div>
<div class="line"><span class="lineno">  446</span>      <a class="code hl_function" href="classPenetrationThread.html#ae8cbc491aace5690cfb51cceb97a9351">smoothNormal</a>(info, p_info, node);</div>
<div class="line"><span class="lineno">  447</span>      <a class="code hl_typedef" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe = <a class="code hl_variable" href="classPenetrationThread.html#ae6706d9502ecbf54b0651cc2f0a7699b">_fes</a>[<a class="code hl_variable" href="classPenetrationThread.html#a1c19836ab3ed65b2aa57ce8e022bcf98">_tid</a>][info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>-&gt;dim()];</div>
<div class="line"><span class="lineno">  448</span>      <a class="code hl_function" href="classPenetrationThread.html#aa200ad4fed9a188c3e5a7287881ed673">computeSlip</a>(*fe, *info);</div>
<div class="line"><span class="lineno">  449</span>    }</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; p_info.size(); ++j)</div>
<div class="line"><span class="lineno">  452</span>    {</div>
<div class="line"><span class="lineno">  453</span>      <span class="keywordflow">if</span> (p_info[j])</div>
<div class="line"><span class="lineno">  454</span>      {</div>
<div class="line"><span class="lineno">  455</span>        <span class="keyword">delete</span> p_info[j];</div>
<div class="line"><span class="lineno">  456</span>        p_info[j] = NULL;</div>
<div class="line"><span class="lineno">  457</span>      }</div>
<div class="line"><span class="lineno">  458</span>    }</div>
<div class="line"><span class="lineno">  459</span>  }</div>
<div class="line"><span class="lineno">  460</span>}</div>
<div class="ttc" id="aPenetrationThread_8C_html_ac80a76b23342a7996513340481755b82"><div class="ttname"><a href="PenetrationThread_8C.html#ac80a76b23342a7996513340481755b82">pinfo_mutex</a></div><div class="ttdeci">Threads::spin_mutex pinfo_mutex</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00025">PenetrationThread.C:25</a></div></div>
<div class="ttc" id="aclassMooseMesh_html_a12c8284113f61e6cdbe91dc0ca931ab4"><div class="ttname"><a href="classMooseMesh.html#a12c8284113f61e6cdbe91dc0ca931ab4">MooseMesh::nodeRef</a></div><div class="ttdeci">virtual const Node &amp; nodeRef(const dof_id_type i) const</div><div class="ttdef"><b>Definition:</b> <a href="MooseMesh_8C_source.html#l00631">MooseMesh.C:631</a></div></div>
<div class="ttc" id="aclassNearestNodeLocator_html_a3944f1d3b86ffac34b1275695fcfc285"><div class="ttname"><a href="classNearestNodeLocator.html#a3944f1d3b86ffac34b1275695fcfc285">NearestNodeLocator::nearestNode</a></div><div class="ttdeci">const Node * nearestNode(dof_id_type node_id)</div><div class="ttdoc">Valid to call this after findNodes() has been called to get a pointer to the nearest node.</div><div class="ttdef"><b>Definition:</b> <a href="NearestNodeLocator_8C_source.html#l00239">NearestNodeLocator.C:239</a></div></div>
<div class="ttc" id="aclassParallelUniqueId_html"><div class="ttname"><a href="classParallelUniqueId.html">ParallelUniqueId</a></div><div class="ttdef"><b>Definition:</b> <a href="ParallelUniqueId_8h_source.html#l00029">ParallelUniqueId.h:30</a></div></div>
<div class="ttc" id="aclassParallelUniqueId_html_ab64d3c23ad4c6cca5ef885b5b5e520cd"><div class="ttname"><a href="classParallelUniqueId.html#ab64d3c23ad4c6cca5ef885b5b5e520cd">ParallelUniqueId::id</a></div><div class="ttdeci">THREAD_ID id</div><div class="ttdef"><b>Definition:</b> <a href="ParallelUniqueId_8h_source.html#l00082">ParallelUniqueId.h:82</a></div></div>
<div class="ttc" id="aclassPenetrationLocator_html_ad5fc0f29548c68007a7e6ca9e13fe418a69f3a4e1a73ee9b163de54e1bdc33710"><div class="ttname"><a href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418a69f3a4e1a73ee9b163de54e1bdc33710">PenetrationLocator::NSM_NODAL_NORMAL_BASED</a></div><div class="ttdeci">@ NSM_NODAL_NORMAL_BASED</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationLocator_8h_source.html#l00053">PenetrationLocator.h:52</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_a89f761e759cbcdd607aa3bfe0cce57a9"><div class="ttname"><a href="classPenetrationThread.html#a89f761e759cbcdd607aa3bfe0cce57a9">PenetrationThread::switchInfo</a></div><div class="ttdeci">void switchInfo(PenetrationInfo *&amp;info, PenetrationInfo *&amp;infoNew)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00471">PenetrationThread.C:471</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_aa200ad4fed9a188c3e5a7287881ed673"><div class="ttname"><a href="classPenetrationThread.html#aa200ad4fed9a188c3e5a7287881ed673">PenetrationThread::computeSlip</a></div><div class="ttdeci">void computeSlip(FEBase &amp;fe, PenetrationInfo &amp;info)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01214">PenetrationThread.C:1214</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_acd8671738159f333a5f235a17ca15bd6"><div class="ttname"><a href="classPenetrationThread.html#acd8671738159f333a5f235a17ca15bd6">PenetrationThread::restrictPointToFace</a></div><div class="ttdeci">bool restrictPointToFace(Point &amp;p, const Node *&amp;closest_node, const Elem *side)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00967">PenetrationThread.C:967</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_ae8cbc491aace5690cfb51cceb97a9351"><div class="ttname"><a href="classPenetrationThread.html#ae8cbc491aace5690cfb51cceb97a9351">PenetrationThread::smoothNormal</a></div><div class="ttdeci">void smoothNormal(PenetrationInfo *info, std::vector&lt; PenetrationInfo * &gt; &amp;p_info, const Node &amp;node)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01233">PenetrationThread.C:1233</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_afce58305a7fce32380a8d3061ca114a3"><div class="ttname"><a href="classPenetrationThread.html#afce58305a7fce32380a8d3061ca114a3">PenetrationThread::competeInteractions</a></div><div class="ttdeci">CompeteInteractionResult competeInteractions(PenetrationInfo *pi1, PenetrationInfo *pi2)</div><div class="ttdoc">When interactions are identified between a node and two faces, compete between the faces to determine...</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00505">PenetrationThread.C:505</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_afed2aedb63399dd31f62684d459c6494"><div class="ttname"><a href="classPenetrationThread.html#afed2aedb63399dd31f62684d459c6494">PenetrationThread::findRidgeContactPoint</a></div><div class="ttdeci">bool findRidgeContactPoint(Point &amp;contact_point, Real &amp;tangential_distance, const Node *&amp;closest_node, unsigned int &amp;index, Point &amp;contact_point_ref, std::vector&lt; PenetrationInfo * &gt; &amp;p_info, const unsigned int index1, const unsigned int index2)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l00651">PenetrationThread.C:651</a></div></div>
<div class="ttc" id="aclassSubProblem_html_a4b526f62e5a78e17092aca0e12e97b1c"><div class="ttname"><a href="classSubProblem.html#a4b526f62e5a78e17092aca0e12e97b1c">SubProblem::getStandardVariable</a></div><div class="ttdeci">virtual MooseVariable &amp; getStandardVariable(const THREAD_ID tid, const std::string &amp;var_name)=0</div><div class="ttdoc">Returns the variable reference for requested MooseVariable which may be in any system.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acd8671738159f333a5f235a17ca15bd6" name="acd8671738159f333a5f235a17ca15bd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd8671738159f333a5f235a17ca15bd6">&#9670;&#160;</a></span>restrictPointToFace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::restrictPointToFace </td>
          <td>(</td>
          <td class="paramtype">Point &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node *&amp;&#160;</td>
          <td class="paramname"><em>closest_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>side</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00967">967</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  968</span>{</div>
<div class="line"><span class="lineno">  969</span>  <span class="keyword">const</span> ElemType t(side-&gt;type());</div>
<div class="line"><span class="lineno">  970</span>  Real &amp; xi = p(0);</div>
<div class="line"><span class="lineno">  971</span>  Real &amp; eta = p(1);</div>
<div class="line"><span class="lineno">  972</span>  closest_node = NULL;</div>
<div class="line"><span class="lineno">  973</span> </div>
<div class="line"><span class="lineno">  974</span>  <span class="keywordtype">bool</span> off_of_this_face(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>  <span class="keywordflow">switch</span> (t)</div>
<div class="line"><span class="lineno">  977</span>  {</div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordflow">case</span> EDGE2:</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">case</span> EDGE3:</div>
<div class="line"><span class="lineno">  980</span>    <span class="keywordflow">case</span> EDGE4:</div>
<div class="line"><span class="lineno">  981</span>    {</div>
<div class="line"><span class="lineno">  982</span>      <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno">  983</span>      {</div>
<div class="line"><span class="lineno">  984</span>        xi = -1.0;</div>
<div class="line"><span class="lineno">  985</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  986</span>        closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  987</span>      }</div>
<div class="line"><span class="lineno">  988</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno">  989</span>      {</div>
<div class="line"><span class="lineno">  990</span>        xi = 1.0;</div>
<div class="line"><span class="lineno">  991</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  992</span>        closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  993</span>      }</div>
<div class="line"><span class="lineno">  994</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  995</span>    }</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>    <span class="keywordflow">case</span> TRI3:</div>
<div class="line"><span class="lineno">  998</span>    <span class="keywordflow">case</span> TRI6:</div>
<div class="line"><span class="lineno">  999</span>    <span class="keywordflow">case</span> TRI7:</div>
<div class="line"><span class="lineno"> 1000</span>    {</div>
<div class="line"><span class="lineno"> 1001</span>      <span class="keywordflow">if</span> (eta &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1002</span>      {</div>
<div class="line"><span class="lineno"> 1003</span>        eta = 0.0;</div>
<div class="line"><span class="lineno"> 1004</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1005</span>        <span class="keywordflow">if</span> (xi &lt; 0.5)</div>
<div class="line"><span class="lineno"> 1006</span>        {</div>
<div class="line"><span class="lineno"> 1007</span>          closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno"> 1008</span>          <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1009</span>            xi = 0.0;</div>
<div class="line"><span class="lineno"> 1010</span>        }</div>
<div class="line"><span class="lineno"> 1011</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1012</span>        {</div>
<div class="line"><span class="lineno"> 1013</span>          closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno"> 1014</span>          <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1015</span>            xi = 1.0;</div>
<div class="line"><span class="lineno"> 1016</span>        }</div>
<div class="line"><span class="lineno"> 1017</span>      }</div>
<div class="line"><span class="lineno"> 1018</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((xi + eta) &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1019</span>      {</div>
<div class="line"><span class="lineno"> 1020</span>        Real delta = (xi + eta - 1.0) / 2.0;</div>
<div class="line"><span class="lineno"> 1021</span>        xi -= delta;</div>
<div class="line"><span class="lineno"> 1022</span>        eta -= delta;</div>
<div class="line"><span class="lineno"> 1023</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1024</span>        <span class="keywordflow">if</span> (xi &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1025</span>        {</div>
<div class="line"><span class="lineno"> 1026</span>          closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno"> 1027</span>          <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1028</span>          {</div>
<div class="line"><span class="lineno"> 1029</span>            xi = 1.0;</div>
<div class="line"><span class="lineno"> 1030</span>            eta = 0.0;</div>
<div class="line"><span class="lineno"> 1031</span>          }</div>
<div class="line"><span class="lineno"> 1032</span>        }</div>
<div class="line"><span class="lineno"> 1033</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1034</span>        {</div>
<div class="line"><span class="lineno"> 1035</span>          closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno"> 1036</span>          <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1037</span>          {</div>
<div class="line"><span class="lineno"> 1038</span>            xi = 0.0;</div>
<div class="line"><span class="lineno"> 1039</span>            eta = 1.0;</div>
<div class="line"><span class="lineno"> 1040</span>          }</div>
<div class="line"><span class="lineno"> 1041</span>        }</div>
<div class="line"><span class="lineno"> 1042</span>      }</div>
<div class="line"><span class="lineno"> 1043</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1044</span>      {</div>
<div class="line"><span class="lineno"> 1045</span>        xi = 0.0;</div>
<div class="line"><span class="lineno"> 1046</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keywordflow">if</span> (eta &gt; 0.5)</div>
<div class="line"><span class="lineno"> 1048</span>        {</div>
<div class="line"><span class="lineno"> 1049</span>          closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno"> 1050</span>          <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1051</span>            eta = 1.0;</div>
<div class="line"><span class="lineno"> 1052</span>        }</div>
<div class="line"><span class="lineno"> 1053</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1054</span>        {</div>
<div class="line"><span class="lineno"> 1055</span>          closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno"> 1056</span>          <span class="keywordflow">if</span> (eta &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1057</span>            eta = 0.0;</div>
<div class="line"><span class="lineno"> 1058</span>        }</div>
<div class="line"><span class="lineno"> 1059</span>      }</div>
<div class="line"><span class="lineno"> 1060</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1061</span>    }</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>    <span class="keywordflow">case</span> QUAD4:</div>
<div class="line"><span class="lineno"> 1064</span>    <span class="keywordflow">case</span> QUAD8:</div>
<div class="line"><span class="lineno"> 1065</span>    <span class="keywordflow">case</span> QUAD9:</div>
<div class="line"><span class="lineno"> 1066</span>    {</div>
<div class="line"><span class="lineno"> 1067</span>      <span class="keywordflow">if</span> (eta &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1068</span>      {</div>
<div class="line"><span class="lineno"> 1069</span>        eta = -1.0;</div>
<div class="line"><span class="lineno"> 1070</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1071</span>        <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1072</span>        {</div>
<div class="line"><span class="lineno"> 1073</span>          closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno"> 1074</span>          <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1075</span>            xi = -1.0;</div>
<div class="line"><span class="lineno"> 1076</span>        }</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1078</span>        {</div>
<div class="line"><span class="lineno"> 1079</span>          closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno"> 1080</span>          <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1081</span>            xi = 1.0;</div>
<div class="line"><span class="lineno"> 1082</span>        }</div>
<div class="line"><span class="lineno"> 1083</span>      }</div>
<div class="line"><span class="lineno"> 1084</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1085</span>      {</div>
<div class="line"><span class="lineno"> 1086</span>        xi = 1.0;</div>
<div class="line"><span class="lineno"> 1087</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1088</span>        <span class="keywordflow">if</span> (eta &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1089</span>        {</div>
<div class="line"><span class="lineno"> 1090</span>          closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno"> 1091</span>          <span class="keywordflow">if</span> (eta &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1092</span>            eta = -1.0;</div>
<div class="line"><span class="lineno"> 1093</span>        }</div>
<div class="line"><span class="lineno"> 1094</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1095</span>        {</div>
<div class="line"><span class="lineno"> 1096</span>          closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno"> 1097</span>          <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1098</span>            eta = 1.0;</div>
<div class="line"><span class="lineno"> 1099</span>        }</div>
<div class="line"><span class="lineno"> 1100</span>      }</div>
<div class="line"><span class="lineno"> 1101</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1102</span>      {</div>
<div class="line"><span class="lineno"> 1103</span>        eta = 1.0;</div>
<div class="line"><span class="lineno"> 1104</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1105</span>        <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1106</span>        {</div>
<div class="line"><span class="lineno"> 1107</span>          closest_node = side-&gt;node_ptr(3);</div>
<div class="line"><span class="lineno"> 1108</span>          <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1109</span>            xi = -1.0;</div>
<div class="line"><span class="lineno"> 1110</span>        }</div>
<div class="line"><span class="lineno"> 1111</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1112</span>        {</div>
<div class="line"><span class="lineno"> 1113</span>          closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno"> 1114</span>          <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1115</span>            xi = 1.0;</div>
<div class="line"><span class="lineno"> 1116</span>        }</div>
<div class="line"><span class="lineno"> 1117</span>      }</div>
<div class="line"><span class="lineno"> 1118</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1119</span>      {</div>
<div class="line"><span class="lineno"> 1120</span>        xi = -1.0;</div>
<div class="line"><span class="lineno"> 1121</span>        off_of_this_face = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1122</span>        <span class="keywordflow">if</span> (eta &lt; 0.0)</div>
<div class="line"><span class="lineno"> 1123</span>        {</div>
<div class="line"><span class="lineno"> 1124</span>          closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno"> 1125</span>          <span class="keywordflow">if</span> (eta &lt; -1.0)</div>
<div class="line"><span class="lineno"> 1126</span>            eta = -1.0;</div>
<div class="line"><span class="lineno"> 1127</span>        }</div>
<div class="line"><span class="lineno"> 1128</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1129</span>        {</div>
<div class="line"><span class="lineno"> 1130</span>          closest_node = side-&gt;node_ptr(3);</div>
<div class="line"><span class="lineno"> 1131</span>          <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno"> 1132</span>            eta = 1.0;</div>
<div class="line"><span class="lineno"> 1133</span>        }</div>
<div class="line"><span class="lineno"> 1134</span>      }</div>
<div class="line"><span class="lineno"> 1135</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1136</span>    }</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1139</span>    {</div>
<div class="line"><span class="lineno"> 1140</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Unsupported face type: &quot;</span>, t);</div>
<div class="line"><span class="lineno"> 1141</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1142</span>    }</div>
<div class="line"><span class="lineno"> 1143</span>  }</div>
<div class="line"><span class="lineno"> 1144</span>  <span class="keywordflow">return</span> off_of_this_face;</div>
<div class="line"><span class="lineno"> 1145</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="aa865ac60b45804ace8ddefe9333c0c7b" name="aa865ac60b45804ace8ddefe9333c0c7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa865ac60b45804ace8ddefe9333c0c7b">&#9670;&#160;</a></span>restrictPointToSpecifiedEdgeOfFace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::restrictPointToSpecifiedEdgeOfFace </td>
          <td>(</td>
          <td class="paramtype">Point &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node *&amp;&#160;</td>
          <td class="paramname"><em>closest_node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; const Node * &gt; &amp;&#160;</td>
          <td class="paramname"><em>edge_nodes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00793">793</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>{</div>
<div class="line"><span class="lineno">  798</span>  <span class="keyword">const</span> ElemType t = side-&gt;type();</div>
<div class="line"><span class="lineno">  799</span>  Real &amp; xi = p(0);</div>
<div class="line"><span class="lineno">  800</span>  Real &amp; eta = p(1);</div>
<div class="line"><span class="lineno">  801</span>  closest_node = NULL;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>  std::vector&lt;unsigned int&gt; local_node_indices;</div>
<div class="line"><span class="lineno">  804</span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; edge_node : edge_nodes)</div>
<div class="line"><span class="lineno">  805</span>  {</div>
<div class="line"><span class="lineno">  806</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> local_index = side-&gt;get_node_index(edge_node);</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">if</span> (local_index == libMesh::invalid_uint)</div>
<div class="line"><span class="lineno">  808</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Side does not contain node&quot;</span>);</div>
<div class="line"><span class="lineno">  809</span>    local_node_indices.push_back(local_index);</div>
<div class="line"><span class="lineno">  810</span>  }</div>
<div class="line"><span class="lineno">  811</span>  mooseAssert(local_node_indices.size() == side-&gt;dim(),</div>
<div class="line"><span class="lineno">  812</span>              <span class="stringliteral">&quot;Number of edge nodes must match side dimensionality&quot;</span>);</div>
<div class="line"><span class="lineno">  813</span>  std::sort(local_node_indices.begin(), local_node_indices.end());</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <span class="keywordtype">bool</span> off_of_this_edge = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>  <span class="keywordflow">switch</span> (t)</div>
<div class="line"><span class="lineno">  818</span>  {</div>
<div class="line"><span class="lineno">  819</span>    <span class="keywordflow">case</span> EDGE2:</div>
<div class="line"><span class="lineno">  820</span>    <span class="keywordflow">case</span> EDGE3:</div>
<div class="line"><span class="lineno">  821</span>    <span class="keywordflow">case</span> EDGE4:</div>
<div class="line"><span class="lineno">  822</span>    {</div>
<div class="line"><span class="lineno">  823</span>      <span class="keywordflow">if</span> (local_node_indices[0] == 0)</div>
<div class="line"><span class="lineno">  824</span>      {</div>
<div class="line"><span class="lineno">  825</span>        <span class="keywordflow">if</span> (xi &lt;= -1.0)</div>
<div class="line"><span class="lineno">  826</span>        {</div>
<div class="line"><span class="lineno">  827</span>          xi = -1.0;</div>
<div class="line"><span class="lineno">  828</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  829</span>          closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  830</span>        }</div>
<div class="line"><span class="lineno">  831</span>      }</div>
<div class="line"><span class="lineno">  832</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (local_node_indices[0] == 1)</div>
<div class="line"><span class="lineno">  833</span>      {</div>
<div class="line"><span class="lineno">  834</span>        <span class="keywordflow">if</span> (xi &gt;= 1.0)</div>
<div class="line"><span class="lineno">  835</span>        {</div>
<div class="line"><span class="lineno">  836</span>          xi = 1.0;</div>
<div class="line"><span class="lineno">  837</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  838</span>          closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  839</span>        }</div>
<div class="line"><span class="lineno">  840</span>      }</div>
<div class="line"><span class="lineno">  841</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  842</span>      {</div>
<div class="line"><span class="lineno">  843</span>        <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid local node indices&quot;</span>);</div>
<div class="line"><span class="lineno">  844</span>      }</div>
<div class="line"><span class="lineno">  845</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  846</span>    }</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>    <span class="keywordflow">case</span> TRI3:</div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">case</span> TRI6:</div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordflow">case</span> TRI7:</div>
<div class="line"><span class="lineno">  851</span>    {</div>
<div class="line"><span class="lineno">  852</span>      <span class="keywordflow">if</span> ((local_node_indices[0] == 0) &amp;&amp; (local_node_indices[1] == 1))</div>
<div class="line"><span class="lineno">  853</span>      {</div>
<div class="line"><span class="lineno">  854</span>        <span class="keywordflow">if</span> (eta &lt;= 0.0)</div>
<div class="line"><span class="lineno">  855</span>        {</div>
<div class="line"><span class="lineno">  856</span>          eta = 0.0;</div>
<div class="line"><span class="lineno">  857</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  858</span>          <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno">  859</span>            closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  860</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno">  861</span>            closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  862</span>        }</div>
<div class="line"><span class="lineno">  863</span>      }</div>
<div class="line"><span class="lineno">  864</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((local_node_indices[0] == 1) &amp;&amp; (local_node_indices[1] == 2))</div>
<div class="line"><span class="lineno">  865</span>      {</div>
<div class="line"><span class="lineno">  866</span>        <span class="keywordflow">if</span> ((xi + eta) &gt; 1.0)</div>
<div class="line"><span class="lineno">  867</span>        {</div>
<div class="line"><span class="lineno">  868</span>          Real delta = (xi + eta - 1.0) / 2.0;</div>
<div class="line"><span class="lineno">  869</span>          xi -= delta;</div>
<div class="line"><span class="lineno">  870</span>          eta -= delta;</div>
<div class="line"><span class="lineno">  871</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  872</span>          <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno">  873</span>            closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  874</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &lt; 0.0)</div>
<div class="line"><span class="lineno">  875</span>            closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno">  876</span>        }</div>
<div class="line"><span class="lineno">  877</span>      }</div>
<div class="line"><span class="lineno">  878</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((local_node_indices[0] == 0) &amp;&amp; (local_node_indices[1] == 2))</div>
<div class="line"><span class="lineno">  879</span>      {</div>
<div class="line"><span class="lineno">  880</span>        <span class="keywordflow">if</span> (xi &lt;= 0.0)</div>
<div class="line"><span class="lineno">  881</span>        {</div>
<div class="line"><span class="lineno">  882</span>          xi = 0.0;</div>
<div class="line"><span class="lineno">  883</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  884</span>          <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno">  885</span>            closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno">  886</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &lt; 0.0)</div>
<div class="line"><span class="lineno">  887</span>            closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  888</span>        }</div>
<div class="line"><span class="lineno">  889</span>      }</div>
<div class="line"><span class="lineno">  890</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  891</span>      {</div>
<div class="line"><span class="lineno">  892</span>        <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid local node indices&quot;</span>);</div>
<div class="line"><span class="lineno">  893</span>      }</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  896</span>    }</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>    <span class="keywordflow">case</span> QUAD4:</div>
<div class="line"><span class="lineno">  899</span>    <span class="keywordflow">case</span> QUAD8:</div>
<div class="line"><span class="lineno">  900</span>    <span class="keywordflow">case</span> QUAD9:</div>
<div class="line"><span class="lineno">  901</span>    {</div>
<div class="line"><span class="lineno">  902</span>      <span class="keywordflow">if</span> ((local_node_indices[0] == 0) &amp;&amp; (local_node_indices[1] == 1))</div>
<div class="line"><span class="lineno">  903</span>      {</div>
<div class="line"><span class="lineno">  904</span>        <span class="keywordflow">if</span> (eta &lt;= -1.0)</div>
<div class="line"><span class="lineno">  905</span>        {</div>
<div class="line"><span class="lineno">  906</span>          eta = -1.0;</div>
<div class="line"><span class="lineno">  907</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  908</span>          <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno">  909</span>            closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  910</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno">  911</span>            closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  912</span>        }</div>
<div class="line"><span class="lineno">  913</span>      }</div>
<div class="line"><span class="lineno">  914</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((local_node_indices[0] == 1) &amp;&amp; (local_node_indices[1] == 2))</div>
<div class="line"><span class="lineno">  915</span>      {</div>
<div class="line"><span class="lineno">  916</span>        <span class="keywordflow">if</span> (xi &gt;= 1.0)</div>
<div class="line"><span class="lineno">  917</span>        {</div>
<div class="line"><span class="lineno">  918</span>          xi = 1.0;</div>
<div class="line"><span class="lineno">  919</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  920</span>          <span class="keywordflow">if</span> (eta &lt; -1.0)</div>
<div class="line"><span class="lineno">  921</span>            closest_node = side-&gt;node_ptr(1);</div>
<div class="line"><span class="lineno">  922</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno">  923</span>            closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno">  924</span>        }</div>
<div class="line"><span class="lineno">  925</span>      }</div>
<div class="line"><span class="lineno">  926</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((local_node_indices[0] == 2) &amp;&amp; (local_node_indices[1] == 3))</div>
<div class="line"><span class="lineno">  927</span>      {</div>
<div class="line"><span class="lineno">  928</span>        <span class="keywordflow">if</span> (eta &gt;= 1.0)</div>
<div class="line"><span class="lineno">  929</span>        {</div>
<div class="line"><span class="lineno">  930</span>          eta = 1.0;</div>
<div class="line"><span class="lineno">  931</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  932</span>          <span class="keywordflow">if</span> (xi &lt; -1.0)</div>
<div class="line"><span class="lineno">  933</span>            closest_node = side-&gt;node_ptr(3);</div>
<div class="line"><span class="lineno">  934</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (xi &gt; 1.0)</div>
<div class="line"><span class="lineno">  935</span>            closest_node = side-&gt;node_ptr(2);</div>
<div class="line"><span class="lineno">  936</span>        }</div>
<div class="line"><span class="lineno">  937</span>      }</div>
<div class="line"><span class="lineno">  938</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((local_node_indices[0] == 0) &amp;&amp; (local_node_indices[1] == 3))</div>
<div class="line"><span class="lineno">  939</span>      {</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">if</span> (xi &lt;= -1.0)</div>
<div class="line"><span class="lineno">  941</span>        {</div>
<div class="line"><span class="lineno">  942</span>          xi = -1.0;</div>
<div class="line"><span class="lineno">  943</span>          off_of_this_edge = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  944</span>          <span class="keywordflow">if</span> (eta &lt; -1.0)</div>
<div class="line"><span class="lineno">  945</span>            closest_node = side-&gt;node_ptr(0);</div>
<div class="line"><span class="lineno">  946</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (eta &gt; 1.0)</div>
<div class="line"><span class="lineno">  947</span>            closest_node = side-&gt;node_ptr(3);</div>
<div class="line"><span class="lineno">  948</span>        }</div>
<div class="line"><span class="lineno">  949</span>      }</div>
<div class="line"><span class="lineno">  950</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  951</span>      {</div>
<div class="line"><span class="lineno">  952</span>        <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Invalid local node indices&quot;</span>);</div>
<div class="line"><span class="lineno">  953</span>      }</div>
<div class="line"><span class="lineno">  954</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  955</span>    }</div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  958</span>    {</div>
<div class="line"><span class="lineno">  959</span>      <a class="code hl_function" href="MooseError_8h.html#aa959168eed29caa7aaa85ffc1319a9ad">mooseError</a>(<span class="stringliteral">&quot;Unsupported face type: &quot;</span>, t);</div>
<div class="line"><span class="lineno">  960</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  961</span>    }</div>
<div class="line"><span class="lineno">  962</span>  }</div>
<div class="line"><span class="lineno">  963</span>  <span class="keywordflow">return</span> off_of_this_edge;</div>
<div class="line"><span class="lineno">  964</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00651">findRidgeContactPoint()</a>.</p>

</div>
</div>
<a id="ae8cbc491aace5690cfb51cceb97a9351" name="ae8cbc491aace5690cfb51cceb97a9351"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8cbc491aace5690cfb51cceb97a9351">&#9670;&#160;</a></span>smoothNormal()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::smoothNormal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>p_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node &amp;&#160;</td>
          <td class="paramname"><em>node</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l01233">1233</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1236</span>{</div>
<div class="line"><span class="lineno"> 1237</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPenetrationThread.html#a8c899c195c1329bff00d82b4601faa75">_do_normal_smoothing</a>)</div>
<div class="line"><span class="lineno"> 1238</span>  {</div>
<div class="line"><span class="lineno"> 1239</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a> == <a class="code hl_enumvalue" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418a1c9d851d27cca40bf3454d9b5f23ea5c">PenetrationLocator::NSM_EDGE_BASED</a>)</div>
<div class="line"><span class="lineno"> 1240</span>    {</div>
<div class="line"><span class="lineno"> 1241</span>      <span class="comment">// If we are within the smoothing distance of any edges or corners, find the</span></div>
<div class="line"><span class="lineno"> 1242</span>      <span class="comment">// corner nodes for those edges/corners, and weights from distance to edge/corner</span></div>
<div class="line"><span class="lineno"> 1243</span>      std::vector&lt;Real&gt; edge_face_weights;</div>
<div class="line"><span class="lineno"> 1244</span>      std::vector&lt;PenetrationInfo *&gt; edge_face_info;</div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>      <a class="code hl_function" href="classPenetrationThread.html#aec2a4106b14e45786a65d2ce6b5fae96">getSmoothingFacesAndWeights</a>(info, edge_face_info, edge_face_weights, p_info, node);</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>      mooseAssert(edge_face_info.size() == edge_face_weights.size(),</div>
<div class="line"><span class="lineno"> 1249</span>                  <span class="stringliteral">&quot;edge_face_info.size() != edge_face_weights.size()&quot;</span>);</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>      <span class="keywordflow">if</span> (edge_face_info.size() &gt; 0)</div>
<div class="line"><span class="lineno"> 1252</span>      {</div>
<div class="line"><span class="lineno"> 1253</span>        <span class="comment">// Smooth the normal using the weighting functions for all participating faces.</span></div>
<div class="line"><span class="lineno"> 1254</span>        <a class="code hl_typedef" href="namespacelibMesh.html#a7b24a45345db9b61375489cb2d385538">RealVectorValue</a> new_normal;</div>
<div class="line"><span class="lineno"> 1255</span>        Real this_face_weight = 1.0;</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> efwi = 0; efwi &lt; edge_face_weights.size(); ++efwi)</div>
<div class="line"><span class="lineno"> 1258</span>        {</div>
<div class="line"><span class="lineno"> 1259</span>          <a class="code hl_class" href="classPenetrationInfo.html">PenetrationInfo</a> * npi = edge_face_info[efwi];</div>
<div class="line"><span class="lineno"> 1260</span>          <span class="keywordflow">if</span> (npi)</div>
<div class="line"><span class="lineno"> 1261</span>            new_normal += npi-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a> * edge_face_weights[efwi];</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>          this_face_weight -= edge_face_weights[efwi];</div>
<div class="line"><span class="lineno"> 1264</span>        }</div>
<div class="line"><span class="lineno"> 1265</span>        mooseAssert(this_face_weight &gt;= (0.25 - 1e-8),</div>
<div class="line"><span class="lineno"> 1266</span>                    <span class="stringliteral">&quot;Sum of weights of other faces shouldn&#39;t exceed 0.75&quot;</span>);</div>
<div class="line"><span class="lineno"> 1267</span>        new_normal += info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a> * this_face_weight;</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>        <span class="keyword">const</span> Real len = new_normal.norm();</div>
<div class="line"><span class="lineno"> 1270</span>        <span class="keywordflow">if</span> (len &gt; 0)</div>
<div class="line"><span class="lineno"> 1271</span>          new_normal /= len;</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span>        info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a> = new_normal;</div>
<div class="line"><span class="lineno"> 1274</span>      }</div>
<div class="line"><span class="lineno"> 1275</span>    }</div>
<div class="line"><span class="lineno"> 1276</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classPenetrationThread.html#ad6786cad0beae15e7ff3b5a8ebe7a8e3">_normal_smoothing_method</a> == <a class="code hl_enumvalue" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418a69f3a4e1a73ee9b163de54e1bdc33710">PenetrationLocator::NSM_NODAL_NORMAL_BASED</a>)</div>
<div class="line"><span class="lineno"> 1277</span>    {</div>
<div class="line"><span class="lineno"> 1278</span>      <span class="comment">// params.addParam&lt;VariableName&gt;(&quot;var_name&quot;,&quot;description&quot;);</span></div>
<div class="line"><span class="lineno"> 1279</span>      <span class="comment">// getParam&lt;VariableName&gt;(&quot;var_name&quot;)</span></div>
<div class="line"><span class="lineno"> 1280</span>      info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a>(0) = <a class="code hl_variable" href="classPenetrationThread.html#a155ca06846b2d2adf31c6a0d0f854ee5">_nodal_normal_x</a>-&gt;<a class="code hl_function" href="classMooseVariableFE.html#a077da9ffa7edbae01d4a56efc9f34595">getValue</a>(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa1f69c4b243871580753c2bae8420b41">_side_phi</a>);</div>
<div class="line"><span class="lineno"> 1281</span>      info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a>(1) = <a class="code hl_variable" href="classPenetrationThread.html#a5f6b5d6b51acb18db71e2d97bc03f6b3">_nodal_normal_y</a>-&gt;<a class="code hl_function" href="classMooseVariableFE.html#a077da9ffa7edbae01d4a56efc9f34595">getValue</a>(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa1f69c4b243871580753c2bae8420b41">_side_phi</a>);</div>
<div class="line"><span class="lineno"> 1282</span>      info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a>(2) = <a class="code hl_variable" href="classPenetrationThread.html#a59b725e379e763363279e9526132b196">_nodal_normal_z</a>-&gt;<a class="code hl_function" href="classMooseVariableFE.html#a077da9ffa7edbae01d4a56efc9f34595">getValue</a>(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a06dc594bc99461c618e5fa2230c90c16">_side</a>, info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa1f69c4b243871580753c2bae8420b41">_side_phi</a>);</div>
<div class="line"><span class="lineno"> 1283</span>      <span class="keyword">const</span> Real len(info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a>.norm());</div>
<div class="line"><span class="lineno"> 1284</span>      <span class="keywordflow">if</span> (len &gt; 0)</div>
<div class="line"><span class="lineno"> 1285</span>        info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">_normal</a> /= len;</div>
<div class="line"><span class="lineno"> 1286</span>    }</div>
<div class="line"><span class="lineno"> 1287</span>  }</div>
<div class="line"><span class="lineno"> 1288</span>}</div>
<div class="ttc" id="aclassMooseVariableFE_html_a077da9ffa7edbae01d4a56efc9f34595"><div class="ttname"><a href="classMooseVariableFE.html#a077da9ffa7edbae01d4a56efc9f34595">MooseVariableFE::getValue</a></div><div class="ttdeci">OutputType getValue(const Elem *elem, const std::vector&lt; std::vector&lt; OutputShape &gt; &gt; &amp;phi) const</div><div class="ttdoc">Compute the variable value at a point on an element.</div><div class="ttdef"><b>Definition:</b> <a href="MooseVariableFE_8C_source.html#l00458">MooseVariableFE.C:458</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_aa1f69c4b243871580753c2bae8420b41"><div class="ttname"><a href="classPenetrationInfo.html#aa1f69c4b243871580753c2bae8420b41">PenetrationInfo::_side_phi</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Real &gt; &gt; _side_phi</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00082">PenetrationInfo.h:82</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_af38cf5a8637ca7a99abff0d78fe51f61"><div class="ttname"><a href="classPenetrationInfo.html#af38cf5a8637ca7a99abff0d78fe51f61">PenetrationInfo::_normal</a></div><div class="ttdeci">RealVectorValue _normal</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00075">PenetrationInfo.h:75</a></div></div>
<div class="ttc" id="aclassPenetrationLocator_html_ad5fc0f29548c68007a7e6ca9e13fe418a1c9d851d27cca40bf3454d9b5f23ea5c"><div class="ttname"><a href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418a1c9d851d27cca40bf3454d9b5f23ea5c">PenetrationLocator::NSM_EDGE_BASED</a></div><div class="ttdeci">@ NSM_EDGE_BASED</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationLocator_8h_source.html#l00051">PenetrationLocator.h:51</a></div></div>
<div class="ttc" id="aclassPenetrationThread_html_aec2a4106b14e45786a65d2ce6b5fae96"><div class="ttname"><a href="classPenetrationThread.html#aec2a4106b14e45786a65d2ce6b5fae96">PenetrationThread::getSmoothingFacesAndWeights</a></div><div class="ttdeci">void getSmoothingFacesAndWeights(PenetrationInfo *info, std::vector&lt; PenetrationInfo * &gt; &amp;edge_face_info, std::vector&lt; Real &gt; &amp;edge_face_weights, std::vector&lt; PenetrationInfo * &gt; &amp;p_info, const Node &amp;secondary_node)</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationThread_8C_source.html#l01291">PenetrationThread.C:1291</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a89f761e759cbcdd607aa3bfe0cce57a9" name="a89f761e759cbcdd607aa3bfe0cce57a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89f761e759cbcdd607aa3bfe0cce57a9">&#9670;&#160;</a></span>switchInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void PenetrationThread::switchInfo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&amp;&#160;</td>
          <td class="paramname"><em>infoNew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8C_source.html#l00471">471</a> of file <a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  472</span>{</div>
<div class="line"><span class="lineno">  473</span>  mooseAssert(infoNew != NULL, <span class="stringliteral">&quot;infoNew object is null&quot;</span>);</div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordflow">if</span> (info)</div>
<div class="line"><span class="lineno">  475</span>  {</div>
<div class="line"><span class="lineno">  476</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ab3f35e6528f94c33b4aa14c5653a0a92">_starting_elem</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ab3f35e6528f94c33b4aa14c5653a0a92">_starting_elem</a>;</div>
<div class="line"><span class="lineno">  477</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a9c3074885aedfb1cee28977259f11d18">_starting_side_num</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a9c3074885aedfb1cee28977259f11d18">_starting_side_num</a>;</div>
<div class="line"><span class="lineno">  478</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#adb3f85f95068b2dbd9d348e4913b896e">_starting_closest_point_ref</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#adb3f85f95068b2dbd9d348e4913b896e">_starting_closest_point_ref</a>;</div>
<div class="line"><span class="lineno">  479</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">_incremental_slip</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a905e9bc1e7096dbb30a581e2e7ae9a7b">_incremental_slip</a>;</div>
<div class="line"><span class="lineno">  480</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac1eed861272a6dc69061c81637f69bfc">_accumulated_slip</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ac1eed861272a6dc69061c81637f69bfc">_accumulated_slip</a>;</div>
<div class="line"><span class="lineno">  481</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a12aa7fc76c20ce38e6293c3df0417e89">_accumulated_slip_old</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a12aa7fc76c20ce38e6293c3df0417e89">_accumulated_slip_old</a>;</div>
<div class="line"><span class="lineno">  482</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a08b7ec7615dfb68b7becc783dc1b395f">_frictional_energy</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a08b7ec7615dfb68b7becc783dc1b395f">_frictional_energy</a>;</div>
<div class="line"><span class="lineno">  483</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a30710f44a73168be4b3134d27ced5dac">_frictional_energy_old</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a30710f44a73168be4b3134d27ced5dac">_frictional_energy_old</a>;</div>
<div class="line"><span class="lineno">  484</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a79bb7287c2e0fe5e7975c1b79b4c166f">_contact_force</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a79bb7287c2e0fe5e7975c1b79b4c166f">_contact_force</a>;</div>
<div class="line"><span class="lineno">  485</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a2e5fce897c530c8fa15ca21ebc95763d">_contact_force_old</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a2e5fce897c530c8fa15ca21ebc95763d">_contact_force_old</a>;</div>
<div class="line"><span class="lineno">  486</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad4c455e8701eb20f8bfb49535862e337">_lagrange_multiplier</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ad4c455e8701eb20f8bfb49535862e337">_lagrange_multiplier</a>;</div>
<div class="line"><span class="lineno">  487</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ae69c9f33a78efaa303cfe67aab9d6c29">_lagrange_multiplier_slip</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ae69c9f33a78efaa303cfe67aab9d6c29">_lagrange_multiplier_slip</a>;</div>
<div class="line"><span class="lineno">  488</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a42cfed385e9afa48dd9d21779feed7d4">_locked_this_step</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a42cfed385e9afa48dd9d21779feed7d4">_locked_this_step</a>;</div>
<div class="line"><span class="lineno">  489</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#afc853631e744768cd9c7c2765cd3bf67">_stick_locked_this_step</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#afc853631e744768cd9c7c2765cd3bf67">_stick_locked_this_step</a>;</div>
<div class="line"><span class="lineno">  490</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a289843f1f18b37fe6f0b0bc2083662cc">_mech_status</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a289843f1f18b37fe6f0b0bc2083662cc">_mech_status</a>;</div>
<div class="line"><span class="lineno">  491</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a5286f426f3a9f787f1d6df4d1b281b3b">_mech_status_old</a> = info-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a5286f426f3a9f787f1d6df4d1b281b3b">_mech_status_old</a>;</div>
<div class="line"><span class="lineno">  492</span>  }</div>
<div class="line"><span class="lineno">  493</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  494</span>  {</div>
<div class="line"><span class="lineno">  495</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#ab3f35e6528f94c33b4aa14c5653a0a92">_starting_elem</a> = infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#aa65d6b06caaa791e2c46565e90b7c655">_elem</a>;</div>
<div class="line"><span class="lineno">  496</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a9c3074885aedfb1cee28977259f11d18">_starting_side_num</a> = infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#adb47b5b7b403ee2f0e3366c4e8970c37">_side_num</a>;</div>
<div class="line"><span class="lineno">  497</span>    infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#adb3f85f95068b2dbd9d348e4913b896e">_starting_closest_point_ref</a> = infoNew-&gt;<a class="code hl_variable" href="classPenetrationInfo.html#a1dac2ba34e69ab7b7b9bb5a4b5ddbf1c">_closest_point_ref</a>;</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span>  <span class="keyword">delete</span> info;</div>
<div class="line"><span class="lineno">  500</span>  info = infoNew;</div>
<div class="line"><span class="lineno">  501</span>  infoNew = NULL; <span class="comment">// Set this to NULL so that we don&#39;t delete it (now owned by _penetration_info).</span></div>
<div class="line"><span class="lineno">  502</span>}</div>
<div class="ttc" id="aclassPenetrationInfo_html_a289843f1f18b37fe6f0b0bc2083662cc"><div class="ttname"><a href="classPenetrationInfo.html#a289843f1f18b37fe6f0b0bc2083662cc">PenetrationInfo::_mech_status</a></div><div class="ttdeci">MECH_STATUS_ENUM _mech_status</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00103">PenetrationInfo.h:103</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a2e5fce897c530c8fa15ca21ebc95763d"><div class="ttname"><a href="classPenetrationInfo.html#a2e5fce897c530c8fa15ca21ebc95763d">PenetrationInfo::_contact_force_old</a></div><div class="ttdeci">RealVectorValue _contact_force_old</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00096">PenetrationInfo.h:96</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a42cfed385e9afa48dd9d21779feed7d4"><div class="ttname"><a href="classPenetrationInfo.html#a42cfed385e9afa48dd9d21779feed7d4">PenetrationInfo::_locked_this_step</a></div><div class="ttdeci">unsigned int _locked_this_step</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00101">PenetrationInfo.h:101</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_a5286f426f3a9f787f1d6df4d1b281b3b"><div class="ttname"><a href="classPenetrationInfo.html#a5286f426f3a9f787f1d6df4d1b281b3b">PenetrationInfo::_mech_status_old</a></div><div class="ttdeci">MECH_STATUS_ENUM _mech_status_old</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00104">PenetrationInfo.h:104</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ad4c455e8701eb20f8bfb49535862e337"><div class="ttname"><a href="classPenetrationInfo.html#ad4c455e8701eb20f8bfb49535862e337">PenetrationInfo::_lagrange_multiplier</a></div><div class="ttdeci">Real _lagrange_multiplier</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00098">PenetrationInfo.h:98</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_adb47b5b7b403ee2f0e3366c4e8970c37"><div class="ttname"><a href="classPenetrationInfo.html#adb47b5b7b403ee2f0e3366c4e8970c37">PenetrationInfo::_side_num</a></div><div class="ttdeci">unsigned int _side_num</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00074">PenetrationInfo.h:74</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_ae69c9f33a78efaa303cfe67aab9d6c29"><div class="ttname"><a href="classPenetrationInfo.html#ae69c9f33a78efaa303cfe67aab9d6c29">PenetrationInfo::_lagrange_multiplier_slip</a></div><div class="ttdeci">RealVectorValue _lagrange_multiplier_slip</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00099">PenetrationInfo.h:99</a></div></div>
<div class="ttc" id="aclassPenetrationInfo_html_afc853631e744768cd9c7c2765cd3bf67"><div class="ttname"><a href="classPenetrationInfo.html#afc853631e744768cd9c7c2765cd3bf67">PenetrationInfo::_stick_locked_this_step</a></div><div class="ttdeci">unsigned int _stick_locked_this_step</div><div class="ttdef"><b>Definition:</b> <a href="PenetrationInfo_8h_source.html#l00102">PenetrationInfo.h:102</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a636421718b7ba96962c4e9d9347476ef" name="a636421718b7ba96962c4e9d9347476ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a636421718b7ba96962c4e9d9347476ef">&#9670;&#160;</a></span>_bc_tuples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;std::tuple&lt;dof_id_type, unsigned short int, boundary_id_type&gt; &gt;&amp; PenetrationThread::_bc_tuples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00084">84</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01745">getSidesOnPrimaryBoundary()</a>.</p>

</div>
</div>
<a id="a288d215a74b64a28d24b1d140cd250ae" name="a288d215a74b64a28d24b1d140cd250ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288d215a74b64a28d24b1d140cd250ae">&#9670;&#160;</a></span>_check_whether_reasonable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::_check_whether_reasonable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00065">65</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a8c899c195c1329bff00d82b4601faa75" name="a8c899c195c1329bff00d82b4601faa75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c899c195c1329bff00d82b4601faa75">&#9670;&#160;</a></span>_do_normal_smoothing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::_do_normal_smoothing</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00068">68</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="afed2112a71c151ab10f9e2ece58ed1d5" name="afed2112a71c151ab10f9e2ece58ed1d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afed2112a71c151ab10f9e2ece58ed1d5">&#9670;&#160;</a></span>_elem_side_builder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ElemSideBuilder PenetrationThread::_elem_side_builder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper for building element sides without extraneous allocation. </p>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00089">89</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01214">computeSlip()</a>.</p>

</div>
</div>
<a id="af1f236c5648c31a2f14b8c8e00cf4f9a" name="af1f236c5648c31a2f14b8c8e00cf4f9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1f236c5648c31a2f14b8c8e00cf4f9a">&#9670;&#160;</a></span>_fe_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">FEType&amp; PenetrationThread::_fe_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00077">77</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="ae6706d9502ecbf54b0651cc2f0a7699b" name="ae6706d9502ecbf54b0651cc2f0a7699b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6706d9502ecbf54b0651cc2f0a7699b">&#9670;&#160;</a></span>_fes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;FEBase *&gt; &gt;&amp; PenetrationThread::_fes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00075">75</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>, <a class="el" href="PenetrationThread_8C_source.html#l00651">findRidgeContactPoint()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="aa54eff71efe30dbc6a66c0a4f265fbde" name="aa54eff71efe30dbc6a66c0a4f265fbde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54eff71efe30dbc6a66c0a4f265fbde">&#9670;&#160;</a></span>_mesh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMooseMesh.html">MooseMesh</a>&amp; PenetrationThread::_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00058">58</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01527">getInfoForFacesWithCommonNodes()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="ad35dd91b4b0d3d7da352448f2db98261" name="ad35dd91b4b0d3d7da352448f2db98261"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad35dd91b4b0d3d7da352448f2db98261">&#9670;&#160;</a></span>_nearest_node</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNearestNodeLocator.html">NearestNodeLocator</a>&amp; PenetrationThread::_nearest_node</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00079">79</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a155ca06846b2d2adf31c6a0d0f854ee5" name="a155ca06846b2d2adf31c6a0d0f854ee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a155ca06846b2d2adf31c6a0d0f854ee5">&#9670;&#160;</a></span>_nodal_normal_x</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a>* PenetrationThread::_nodal_normal_x</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00071">71</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="a5f6b5d6b51acb18db71e2d97bc03f6b3" name="a5f6b5d6b51acb18db71e2d97bc03f6b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f6b5d6b51acb18db71e2d97bc03f6b3">&#9670;&#160;</a></span>_nodal_normal_y</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a>* PenetrationThread::_nodal_normal_y</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00072">72</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="a59b725e379e763363279e9526132b196" name="a59b725e379e763363279e9526132b196"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59b725e379e763363279e9526132b196">&#9670;&#160;</a></span>_nodal_normal_z</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="PenetrationThread_8h.html#a335aeb9f69cdacd39cf6ca881c0d0451">MooseVariable</a>* PenetrationThread::_nodal_normal_z</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00073">73</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="ab5e53096048ca50930377df4b1d37354" name="ab5e53096048ca50930377df4b1d37354"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5e53096048ca50930377df4b1d37354">&#9670;&#160;</a></span>_node_to_elem_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt;dof_id_type, std::vector&lt;dof_id_type&gt; &gt;&amp; PenetrationThread::_node_to_elem_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00081">81</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01527">getInfoForFacesWithCommonNodes()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="ac9bd6652bbfa243effaa2c88f21c9582" name="ac9bd6652bbfa243effaa2c88f21c9582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9bd6652bbfa243effaa2c88f21c9582">&#9670;&#160;</a></span>_normal_smoothing_distance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real PenetrationThread::_normal_smoothing_distance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00069">69</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01386">getSmoothingEdgeNodesAndWeights()</a>.</p>

</div>
</div>
<a id="ad6786cad0beae15e7ff3b5a8ebe7a8e3" name="ad6786cad0beae15e7ff3b5a8ebe7a8e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6786cad0beae15e7ff3b5a8ebe7a8e3">&#9670;&#160;</a></span>_normal_smoothing_method</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPenetrationLocator.html#ad5fc0f29548c68007a7e6ca9e13fe418">PenetrationLocator::NORMAL_SMOOTHING_METHOD</a> PenetrationThread::_normal_smoothing_method</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00070">70</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l01233">smoothNormal()</a>.</p>

</div>
</div>
<a id="a13db996555fd7db080562a79a5ecac48" name="a13db996555fd7db080562a79a5ecac48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13db996555fd7db080562a79a5ecac48">&#9670;&#160;</a></span>_penetration_info</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;dof_id_type, <a class="el" href="classPenetrationInfo.html">PenetrationInfo</a> *&gt;&amp; PenetrationThread::_penetration_info</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00063">63</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="afa5fba35e105afe524a8d54249d3afe8" name="afa5fba35e105afe524a8d54249d3afe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa5fba35e105afe524a8d54249d3afe8">&#9670;&#160;</a></span>_primary_boundary</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a> PenetrationThread::_primary_boundary</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00059">59</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01745">getSidesOnPrimaryBoundary()</a>.</p>

</div>
</div>
<a id="a5e6f815a9ef19c2835a0d017ba8201b5" name="a5e6f815a9ef19c2835a0d017ba8201b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e6f815a9ef19c2835a0d017ba8201b5">&#9670;&#160;</a></span>_recheck_secondary_nodes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;dof_id_type&gt; PenetrationThread::_recheck_secondary_nodes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>List of secondary nodes for which penetration was not detected in the current patch and for which patch has to be updated. </p>

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00053">53</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationLocator_8C_source.html#l00100">PenetrationLocator::detectPenetration()</a>, <a class="el" href="PenetrationThread_8C_source.html#l00463">join()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a8714749cf9b5fe2483b844342daab7ad" name="a8714749cf9b5fe2483b844342daab7ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8714749cf9b5fe2483b844342daab7ad">&#9670;&#160;</a></span>_secondary_boundary</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="AutomaticMortarGeneration_8h.html#acdf40e62836d2c708e17f9e204b0f877">BoundaryID</a> PenetrationThread::_secondary_boundary</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00060">60</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

</div>
</div>
<a id="af12aa39941322927db05b53db5015973" name="af12aa39941322927db05b53db5015973"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af12aa39941322927db05b53db5015973">&#9670;&#160;</a></span>_subproblem</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSubProblem.html">SubProblem</a>&amp; PenetrationThread::_subproblem</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00056">56</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a7175fbcdc90c32d942dad42ad93d5474" name="a7175fbcdc90c32d942dad42ad93d5474"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7175fbcdc90c32d942dad42ad93d5474">&#9670;&#160;</a></span>_tangential_tolerance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real PenetrationThread::_tangential_tolerance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00067">67</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00505">competeInteractions()</a>, <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a1c19836ab3ed65b2aa57ce8e022bcf98" name="a1c19836ab3ed65b2aa57ce8e022bcf98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c19836ab3ed65b2aa57ce8e022bcf98">&#9670;&#160;</a></span>_tid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="MooseTypes_8h.html#ad3086fc227668c55ccebaeb1c676fc3a">THREAD_ID</a> PenetrationThread::_tid</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00086">86</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l01632">createInfoForElem()</a>, <a class="el" href="PenetrationThread_8C_source.html#l00651">findRidgeContactPoint()</a>, and <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<a id="a82ae4101cc5ecf1533d16822c24ef746" name="a82ae4101cc5ecf1533d16822c24ef746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82ae4101cc5ecf1533d16822c24ef746">&#9670;&#160;</a></span>_update_location</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool PenetrationThread::_update_location</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="PenetrationThread_8h_source.html#l00066">66</a> of file <a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="PenetrationThread_8C_source.html#l00088">operator()()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>moose/framework/include/geomsearch/<a class="el" href="PenetrationThread_8h_source.html">PenetrationThread.h</a></li>
<li>moose/framework/src/geomsearch/<a class="el" href="PenetrationThread_8C_source.html">PenetrationThread.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Dec 24 2023 00:29:17 for Zapdos by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
